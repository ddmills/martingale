{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/geotic/build/geotic.js","src/app.js","src/boot.js","src/components/bounds.js","src/components/index.js","src/components/position-bound-sprite.js","src/components/position.js","src/components/renderable.js","src/components/spawnable.js","src/components/sprite.js","src/entities/entity-factory.js","src/entities/index.js","src/entities/pine-tree.js","src/entities/shrub.js","src/entities/tower.js","src/input/command-queue.js","src/input/commands/command.js","src/input/commands/spawn-entity-command.js","src/input/controllers/input-controller.js","src/input/controllers/map-input-controller.js","src/phaser/bootstrap.js","src/phaser/tile.js","src/prefabs/map.js","src/states/game.js","src/states/loading.js","src/states/preload.js","src/systems/bounds.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"boot.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _id = 0;\nvar id = function id() {\n  return ++_id;\n};\n\nvar hash = function hash(n) {\n  return n.sort(function (a, b) {\n    return a > b;\n  }).join('$');\n};\nvar remove = function remove(a, v) {\n  return a.splice(a.indexOf(v), 1);\n};\nvar getComponent = function getComponent(n) {\n  return components.get(n) || newComponent(n);\n};\nvar clone = function clone(o) {\n  return JSON.parse(JSON.stringify(o));\n};\nvar sigs = new Map();\nvar tsigs = new Map();\nvar tags = new Map();\nvar entities = [];\nvar components = new Map();\n\nvar Signature = function () {\n  function Signature(n) {\n    var _this = this;\n\n    _classCallCheck(this, Signature);\n\n    this.na = n;\n    this.en = [];\n    entities.forEach(function (e) {\n      return _this.onAdd(e);\n    });\n  }\n\n  _createClass(Signature, [{\n    key: 'match',\n    value: function match(e) {\n      var k = Object.keys(e.components);\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this.na[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var n = _step.value;\n\n          if (!k.includes(n)) return false;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return true;\n    }\n  }, {\n    key: 'onAdd',\n    value: function onAdd(e) {\n      if (this.en.includes(e)) return;\n      this.match(e) && this.en.push(e);\n    }\n  }, {\n    key: 'onRem',\n    value: function onRem(e, c) {\n      this.na.includes(c) && remove(this.en, e);\n    }\n  }], [{\n    key: 'get',\n    value: function get(n) {\n      var h = hash(n);\n      return sigs.has(h) ? sigs.get(h) : Signature.make(n, h);\n    }\n  }, {\n    key: 'make',\n    value: function make(n, h) {\n      var t = new Signature(n);\n      sigs.set(h, t);\n      return t;\n    }\n  }]);\n\n  return Signature;\n}();\n\nvar TagSignature = function (_Signature) {\n  _inherits(TagSignature, _Signature);\n\n  function TagSignature() {\n    _classCallCheck(this, TagSignature);\n\n    return _possibleConstructorReturn(this, Object.getPrototypeOf(TagSignature).apply(this, arguments));\n  }\n\n  _createClass(TagSignature, [{\n    key: 'match',\n    value: function match(e) {\n      var k = Object.keys(e.tags);\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = this.na[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var n = _step2.value;\n\n          if (!k.includes(n)) return false;\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n\n      this.en.push(e);\n    }\n  }], [{\n    key: 'get',\n    value: function get(n) {\n      var h = hash(n);\n      return tsigs.has(h) ? tsigs.get(h) : TagSignature.make(n, h);\n    }\n  }, {\n    key: 'make',\n    value: function make(n, h) {\n      var t = new TagSignature(n);\n      tsigs.set(h, t);\n      return t;\n    }\n  }]);\n\n  return TagSignature;\n}(Signature);\n\nvar reserve = ['id', 'listeners', 'serialize', 'deserialize', 'add', 'remove', 'has', 'destroy', 'tag', 'tags', 'untag', 'components', 'on', 'off', 'once', 'emit'];\n\nvar Entity = function () {\n  function Entity(id) {\n    _classCallCheck(this, Entity);\n\n    this.id = id;\n    this.tags = {};\n    this.listeners = new Map();\n  }\n\n  _createClass(Entity, [{\n    key: 'serialize',\n    value: function serialize() {\n      var _this3 = this;\n\n      return {\n        id: this.id,\n        tags: Object.keys(this.t),\n        components: function () {\n          var s = [];\n          var _iteratorNormalCompletion3 = true;\n          var _didIteratorError3 = false;\n          var _iteratorError3 = undefined;\n\n          try {\n            for (var _iterator3 = Object.keys(_this3.components)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n              var n = _step3.value;\n\n              s.push({\n                name: n,\n                value: _this3[n].serialize ? _this3[n].serialize() : clone(_this3[n])\n              });\n            }\n          } catch (err) {\n            _didIteratorError3 = true;\n            _iteratorError3 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                _iterator3.return();\n              }\n            } finally {\n              if (_didIteratorError3) {\n                throw _iteratorError3;\n              }\n            }\n          }\n\n          return s;\n        }()\n      };\n    }\n  }, {\n    key: 'add',\n    value: function add(n) {\n      for (var _len = arguments.length, a = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        a[_key - 1] = arguments[_key];\n      }\n\n      attachTo(this, n, getComponent(n).apply(undefined, [this].concat(a)));\n      return this;\n    }\n  }, {\n    key: 'remove',\n    value: function remove(n) {\n      var _n,\n          _this4 = this;\n\n      if (!this[n]) return;\n\n      for (var _len2 = arguments.length, a = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n        a[_key2 - 1] = arguments[_key2];\n      }\n\n      this[n].unmount && (_n = this[n]).unmount.apply(_n, [this].concat(a));\n      delete this[n];\n      sigs.forEach(function (t) {\n        return t.onRem(_this4, n);\n      });\n      return this;\n    }\n  }, {\n    key: 'mandate',\n    value: function mandate(n) {\n      for (var _len3 = arguments.length, a = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n        a[_key3 - 1] = arguments[_key3];\n      }\n\n      if (!this[n]) this.add.apply(this, [n].concat(a));\n      return this[n];\n    }\n  }, {\n    key: 'has',\n    value: function has(n) {\n      return !!this[n];\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      _destroy(this);\n    }\n  }, {\n    key: 'tag',\n    value: function tag(n) {\n      var _this5 = this;\n\n      var a = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n      var t = getTag(n);\n      Object.assign(t, a);\n      if (n in this.tags) return this;\n      this.tags[n] = t;\n      tsigs.forEach(function (t) {\n        return t.onAdd(_this5);\n      });\n      return this;\n    }\n  }, {\n    key: 'untag',\n    value: function untag(n) {\n      var _this6 = this;\n\n      if (!this.tags[n]) return;\n      delete this.tags[n];\n      tsigs.forEach(function (t) {\n        return t.onRem(_this6, n);\n      });\n      return this;\n    }\n  }, {\n    key: 'on',\n    value: function on(e, f) {\n      this.listeners.has(e) || this.listeners.set(e, []);\n      this.listeners.get(e).push(f);\n      return this;\n    }\n  }, {\n    key: 'once',\n    value: function once(e, f) {\n      var _this7 = this;\n\n      var fn = function fn() {\n        _this7.off(e, f);\n        f.apply(undefined, arguments);\n      };\n      fn._ = f;\n      return this.on(e, fn);\n    }\n  }, {\n    key: 'off',\n    value: function off(e, f) {\n      var ls = this.listeners.get(e);\n      if (ls && ls.length) {\n        ls.forEach(function (l, i) {\n          if (l === f || l._ === f) {\n            ls.splice(i, 1);\n          }\n        });\n      }\n\n      ls.length ? this.listeners.set(e, ls) : this.listeners.delete(e);\n\n      return this;\n    }\n  }, {\n    key: 'emit',\n    value: function emit(e) {\n      for (var _len4 = arguments.length, a = Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n        a[_key4 - 1] = arguments[_key4];\n      }\n\n      var ls = this.listeners.get(e);\n      if (ls && ls.length) {\n        ls.forEach(function (l) {\n          return l.apply(undefined, a);\n        });\n      }\n      return this;\n    }\n  }, {\n    key: 'components',\n    get: function get() {\n      var _this8 = this;\n\n      var c = {};\n      Object.keys(this).filter(function (k) {\n        return !reserve.includes(k);\n      }).forEach(function (k) {\n        return c[k] = _this8[k];\n      });\n      return c;\n    }\n  }], [{\n    key: 'deserialize',\n    value: function deserialize(d) {\n      var e = entity(d.id);\n      d.tags.forEach(function (t) {\n        return e.tag(t);\n      });\n      d.components.forEach(function (c) {\n        var m = getComponent(c.name);\n        if (m.deserialize) {\n          attachTo(e, c.name, m.deserialize(e, c.value));\n        } else {\n          if (_typeof(c.value) !== 'object') {\n            attachTo(e, c.name, c.value);\n            return;\n          }\n          var ins = m(e) || {};\n          Object.assign(ins, c.value);\n          attachTo(e, c.name, ins);\n        }\n      });\n    }\n  }]);\n\n  return Entity;\n}();\n\nvar attachTo = function attachTo(e, n, c) {\n  e[n] = c;\n  c.mount && c.mount(e);\n  sigs.forEach(function (s) {\n    return s.onAdd(e);\n  });\n};\n\nvar newComponent = function newComponent(n) {\n  var c = function c(entity) {};\n  components.set(n, c);\n  return c;\n};\n\nvar newTag = function newTag(n) {\n  var t = {};\n  tags.set(n, t);\n  return t;\n};\n\nvar szTags = function szTags() {\n  return [].concat(_toConsumableArray(tags)).map(function (v) {\n    return {\n      name: v[0],\n      value: v[1].serialize ? v[1].serialize() : clone(v[1])\n    };\n  });\n};\n\nvar szEnts = function szEnts() {\n  return entities.map(function (e) {\n    return e.serialize();\n  });\n};\nvar getTag = exports.getTag = function getTag(n) {\n  return tags.get(n) || newTag(n);\n};\nvar component = exports.component = function component(n, d) {\n  if (reserve.includes(n)) throw 'Cannot use a reserved keyword as a component';\n  components.set(n, d);\n};\nvar findByComponent = exports.findByComponent = function findByComponent() {\n  for (var _len5 = arguments.length, n = Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n    n[_key5] = arguments[_key5];\n  }\n\n  return Signature.get(n).en;\n};\nvar findByTag = exports.findByTag = function findByTag() {\n  for (var _len6 = arguments.length, n = Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n    n[_key6] = arguments[_key6];\n  }\n\n  return TagSignature.get(n).en;\n};\nvar findById = exports.findById = function findById(id) {\n  return entities.find(function (e) {\n    return e.id === id;\n  });\n};\nvar serialize = exports.serialize = function serialize() {\n  return { tags: szTags(), entities: szEnts() };\n};\nvar entity = exports.entity = function entity() {\n  var i = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];\n\n  var e = new Entity(i || id());\n  entities.push(e);\n  sigs.forEach(function (t) {\n    return t.match(e);\n  });\n  return e;\n};\n\nvar deserialize = exports.deserialize = function deserialize(data) {\n  data.tags.forEach(function (t) {\n    return Object.assign(getTag(t.name), t.value);\n  });\n  data.entities.forEach(function (e) {\n    return Entity.deserialize(e);\n  });\n};\n\nvar _destroy = function _destroy(e) {\n  var _iteratorNormalCompletion4 = true;\n  var _didIteratorError4 = false;\n  var _iteratorError4 = undefined;\n\n  try {\n    for (var _iterator4 = Object.keys(e.components)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n      var n = _step4.value;\n      e.remove(n);\n    }\n  } catch (err) {\n    _didIteratorError4 = true;\n    _iteratorError4 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion4 && _iterator4.return) {\n        _iterator4.return();\n      }\n    } finally {\n      if (_didIteratorError4) {\n        throw _iteratorError4;\n      }\n    }\n  }\n\n  var _iteratorNormalCompletion5 = true;\n  var _didIteratorError5 = false;\n  var _iteratorError5 = undefined;\n\n  try {\n    for (var _iterator5 = Object.keys(e.tags)[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n      var t = _step5.value;\n      e.untag(t);\n    }\n  } catch (err) {\n    _didIteratorError5 = true;\n    _iteratorError5 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion5 && _iterator5.return) {\n        _iterator5.return();\n      }\n    } finally {\n      if (_didIteratorError5) {\n        throw _iteratorError5;\n      }\n    }\n  }\n\n  remove(entities, e);\n};\n\nexports.destroy = _destroy;\nvar clear = exports.clear = function clear() {\n  entities.forEach(function (e) {\n    return e.destroy();\n  });\n  sigs = new Map();\n  tsigs = new Map();\n  tags = new Map();\n  entities = [];\n};\n\nexports.default = {\n  clear: clear,\n  entity: entity,\n  getTag: getTag,\n  destroy: _destroy,\n  findById: findById,\n  findByTag: findByTag,\n  serialize: serialize,\n  deserialize: deserialize,\n  component: component,\n  findByComponent: findByComponent\n};","import EntityFactory from './entities/entity-factory';\r\nimport CommandQueue from './input/command-queue';\r\nimport MapInputController from './input/controllers/map-input-controller';\r\nimport Map from './prefabs/map';\r\nimport BoundsSystem from './systems/bounds';\r\n\r\nclass App {\r\n  init(game) {\r\n    this.game = game;\r\n    this.input = this.game.input;\r\n    this.create = new EntityFactory;\r\n    this.map = new Map('paradise');\r\n    this.commandQueue = new CommandQueue();\r\n    this.inputController = new MapInputController();\r\n    this.systems = {\r\n      bounds: new BoundsSystem,\r\n    };\r\n\r\n    // this.systems.bounds.debug = true;\r\n  }\r\n\r\n  get constants() {\r\n    return {\r\n      'TILE_SIZE': 16,\r\n    };\r\n  }\r\n\r\n  worldX(x) {\r\n    return x * this.constants.TILE_SIZE;\r\n  }\r\n\r\n  worldY(y) {\r\n    return y * this.constants.TILE_SIZE;\r\n  }\r\n\r\n  tileX(worldX) {\r\n    return Math.floor(worldX / this.constants.TILE_SIZE);\r\n  }\r\n\r\n  tileY(worldY) {\r\n    return Math.floor(worldY / this.constants.TILE_SIZE);\r\n  }\r\n\r\n  update() {\r\n    this.inputController.handle();\r\n    this.commandQueue.processAll();\r\n    this.systems.bounds.update();\r\n  }\r\n};\r\n\r\nlet app = new App;\r\n\r\nexport { app };\r\nexport default app;\r\n","import './phaser/bootstrap';\r\nimport Preload from './states/preload';\r\nimport Loading from './states/loading';\r\nimport Game from './states/game';\r\nimport './components';\r\nimport './entities';\r\n\r\nclass Boot extends Phaser.Game {\r\n  constructor() {\r\n    super(16 * 16, 16 * 16, Phaser.AUTO, 'game-container', null, false, false);\r\n\r\n    this.state.add('Preload', Preload);\r\n    this.state.add('Loading', Loading);\r\n    this.state.add('Game', Game);\r\n\r\n    this.state.start('Preload');\r\n  }\r\n};\r\n\r\nnew Boot;\r\n","import { component } from 'geotic';\r\nimport app from '../app';\r\n\r\nclass Bounds {\r\n  constructor(position, width = 1, height = 1, offsetX = 0, offsetY = 0) {\r\n    this.position = position;\r\n    this.width = width;\r\n    this.height = height;\r\n    this.offsetX = offsetX;\r\n    this.offsetY = offsetY;\r\n  }\r\n\r\n  get worldX() {\r\n    return app.worldX(this.leftBound);\r\n  }\r\n\r\n  get worldY() {\r\n    return app.worldY(this.topBound);\r\n  }\r\n\r\n  get worldWidth() {\r\n    return this.width * app.constants.TILE_SIZE;\r\n  }\r\n\r\n  get worldHeight() {\r\n    return this.height * app.constants.TILE_SIZE;\r\n  }\r\n\r\n  get leftBound() {\r\n    return this.position.x + this.offsetX;\r\n  }\r\n\r\n  get rightBound() {\r\n    return this.position.x + this.width + this.offsetX;\r\n  }\r\n\r\n  get topBound() {\r\n    return this.position.y + this.offsetY;\r\n  }\r\n\r\n  get bottomBound() {\r\n    return this.position.y + this.height + this.offsetY;\r\n  }\r\n\r\n  contains(x, y) {\r\n    return x > this.leftBound\r\n      && x < this.rightBound\r\n      && y > this.topBound\r\n      && y < this.bottomBound;\r\n  }\r\n\r\n  collidesLeft(other) {\r\n    return this.leftBound < other.rightBound && this.leftBound >= other.leftBound;\r\n  }\r\n\r\n  collidesRight(other) {\r\n    return this.rightBound > other.leftBound && this.rightBound <= other.rightBound;\r\n  }\r\n\r\n  collidesTop(other) {\r\n    return this.topBound < other.bottomBound && this.topBound >= other.topBound;\r\n  }\r\n\r\n  collidesBottom(other) {\r\n    return this.bottomBound > other.topBound && this.bottomBound <= other.bottomBound;\r\n  }\r\n\r\n  collidesWith(other) {\r\n    return (other != this)\r\n      && (this.collidesLeft(other) || this.collidesRight(other))\r\n      && (this.collidesTop(other) || this.collidesBottom(other));\r\n  }\r\n\r\n  debug() {\r\n    const rect = new Phaser.Rectangle(\r\n      this.worldX,\r\n      this.worldY,\r\n      this.worldWidth,\r\n      this.worldHeight\r\n    );\r\n\r\n    app.game.debug.rectangle(rect, '#e300ff', false);\r\n  }\r\n}\r\n\r\ncomponent('bounds', (entity, ...args) => {\r\n  const position = entity.mandate('position');\r\n  return new Bounds(position, ...args);\r\n});\r\n","export { default as sprite } from './sprite';\nexport { default as renderable } from './renderable';\nexport { default as spawnable } from './spawnable';\nexport { default as position } from './position';\nexport { default as bounds } from './bounds';\nexport { default as positionBoundSprite } from './position-bound-sprite';\n","import { component } from 'geotic';\r\nimport { app } from './../app';\r\n\r\nclass PositionBoundSprite {\r\n  constructor(position, sprite, offsetX = 0, offsetY = 0) {\r\n    this.position = position;\r\n    this.sprite = sprite;\r\n    this.offsetX = offsetX;\r\n    this.offsetY = offsetY;\r\n    this.synchronizeSprite()\r\n  }\r\n\r\n  synchronizeSprite() {\r\n    this.sprite.x = this.position.worldX + this.offsetX;\r\n    this.sprite.y = this.position.worldY + this.offsetY;\r\n  }\r\n}\r\n\r\ncomponent('position-bound-sprite', (entity, ...args) => {\r\n  const position = entity.mandate('position');\r\n  const sprite = entity.mandate('sprite');\r\n  const binder = new PositionBoundSprite(position, sprite, ...args);\r\n\r\n  entity.on('position-changed', binder.synchronizeSprite.bind(binder));\r\n\r\n  return binder;\r\n});\r\n","import { component } from 'geotic';\r\nimport { app } from './../app';\r\n\r\nclass Position {\r\n  constructor(entity, x = 0, y = 0) {\r\n    this.entity = entity;\r\n    this._x = x;\r\n    this._y = y;\r\n  }\r\n\r\n  get compacted() {\r\n    return {\r\n      x: this._x,\r\n      y: this._y,\r\n    };\r\n  }\r\n\r\n  set x(newX) {\r\n    const oldPosition = this.compacted;\r\n    this._x = newX;\r\n    const newPosition = this.compacted;\r\n    console.log('emit position changed');\r\n    this.entity.emit('position-changed', oldPosition, newPosition);\r\n  }\r\n\r\n  set y(newY) {\r\n    const oldPosition = this.compacted;\r\n    this._y = newY;\r\n    const newPosition = this.compacted;\r\n    this.entity.emit('position-changed', oldPosition, newPosition);\r\n  }\r\n\r\n  get x() { return this._x; }\r\n  get y() { return this._y; }\r\n\r\n  get worldX() {\r\n    return this._x * app.constants.TILE_SIZE;\r\n  }\r\n\r\n  get worldY() {\r\n    return this._y * app.constants.TILE_SIZE;\r\n  }\r\n}\r\n\r\ncomponent('position', (entity, x = 0, y = 0) => new Position(entity, x, y));\r\n","import { component } from 'geotic';\r\nimport { app } from './../app';\r\n\r\nclass Renderable {\r\n  constructor(subject) {\r\n    this.subject = subject;\r\n  }\r\n\r\n  render(canvas) {\r\n    return canvas.add(this.subject);\r\n  }\r\n}\r\n\r\ncomponent('renderable', (entity, subject) => {\r\n  const r = new Renderable(subject);\r\n  entity.render = r.render.bind(r);\r\n  return r;\r\n});\r\n","import { component } from 'geotic';\r\nimport { app } from './../app';\r\n\r\nclass Spawnable {\r\n  constructor(entity, test) {\r\n    this.entity = entity;\r\n    this.test = test;\r\n    this.entity.spawn = this.spawn.bind(this);\r\n    this.entity.canSpawnAt = this.canSpawnAt.bind(this);\r\n  }\r\n\r\n  canSpawnAt(x, y) {\r\n    return this.test(x, y);\r\n  }\r\n\r\n  spawn() {\r\n    this.entity.emit('spawn');\r\n    return this.entity;\r\n  }\r\n}\r\n\r\ncomponent('spawnable', (entity, test = () => {}) => new Spawnable(entity, test));\r\n","import { component } from 'geotic';\r\nimport { app } from './../app';\r\n\r\ncomponent('sprite', (entity, ...args) => {\r\n  let x, y = 0;\r\n  let key, frame = null;\r\n\r\n  switch(args.length) {\r\n    case 0:\r\n      break;\r\n    case 1:\r\n      key = args[0];\r\n      break;\r\n    case 2:\r\n      key = args[0];\r\n      frame = args[1];\r\n      break;\r\n    case 3:\r\n      x = args[0];\r\n      y = args[1];\r\n      key = args[2];\r\n      break;\r\n    case 4:\r\n      x = args[0];\r\n      y = args[1];\r\n      key = args[2];\r\n      frame = args[3];\r\n      break;\r\n  }\r\n\r\n  const sprite = new Phaser.Sprite(app.game, x, y, key, frame);\r\n  sprite.unmount = (e) => {\r\n    sprite.destroy();\r\n  };\r\n\r\n  entity.mandate('renderable', sprite);\r\n  return sprite;\r\n});\r\n","import entities from './index';\r\n\r\nexport default class EntityFactory {\r\n  tower(x, y) {\r\n    return entities.tower(x, y);\r\n  }\r\n  shrub(x, y) {\r\n    return entities.shrub(x, y);\r\n  }\r\n  pineTree(x, y) {\r\n    return entities.pineTree(x, y);\r\n  }\r\n}\r\n","import tower from './tower';\nimport shrub from './shrub';\nimport pineTree from './pine-tree';\n\nexport { tower };\nexport { shrub };\nexport { pineTree };\nexport default { tower, shrub, pineTree };\n","import { entity } from 'geotic';\r\nimport geotic from 'geotic';\r\nimport app from '../app';\r\n\r\nexport default (x, y) => {\r\n  const tree = entity()\r\n    .add('position', x, y)\r\n    .add('sprite', 'pine-tree')\r\n    .add('position-bound-sprite', 0, -16)\r\n    .add('spawnable', (x, y) => {\r\n      return geotic\r\n        .findByComponent('bounds')\r\n        .every(e => !tree.bounds.collidesWith(e.bounds));\r\n    })\r\n    .add('bounds')\r\n    .once('spawn', () => {\r\n      tree.render(app.map.static);\r\n      app.map.static.sort('y');\r\n      console.log('tree spawned.');\r\n    });\r\n\r\n  setTimeout(() => {\r\n    tree.destroy();\r\n  }, 2000);\r\n\r\n  return tree;\r\n};\r\n","import { entity } from 'geotic';\r\nimport app from '../app';\r\n\r\nexport default (x, y) => {\r\n  const shrub = entity()\r\n    .add('sprite', app.worldX(x), app.worldY(y), 32, 32, 'shrub')\r\n    .add('spawnable')\r\n    .on('spawn', () => shrub.render(app.map.static));\r\n\r\n  return shrub;\r\n};\r\n","import { entity } from 'geotic';\r\nimport app from '../app';\r\n\r\nexport default (x, y) => {\r\n  const tower = entity()\r\n    .add('sprite', app.worldX(x), app.worldY(y) - 16, 16, 32, 'tower')\r\n    .add('spawnable');\r\n    // .on('spawn', () => tower.render(app.map.walls));\r\n\r\n  return tower;\r\n};\r\n","export default class CommandQueue {\r\n  constructor(commands = []) {\r\n    this.commands = [];\r\n    commands.forEach(c => this.push(c));\r\n  }\r\n\r\n  process() {\r\n    if (this.commands.length) {\r\n      const command = this.commands.shift();\r\n      command.execute();\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  processAll() {\r\n    this.process() && this.processAll();\r\n  }\r\n\r\n  push(command) {\r\n    this.commands.push(command);\r\n  }\r\n}\r\n","export default class Command {\r\n  execute() {\r\n  }\r\n}\r\n","import Command from './command';\r\n\r\nexport default class SpawnEntityCommand extends Command {\r\n  constructor(entity) {\r\n    super();\r\n    this.entity = entity;\r\n  }\r\n\r\n  execute() {\r\n    this.entity.spawn();\r\n  }\r\n}\r\n","export default class InputController {\r\n  constructor(queue) {\r\n    this.queue = queue;\r\n  }\r\n\r\n  handle() {\r\n  }\r\n\r\n  queueCommand(command) {\r\n    this.queue.push(command);\r\n  }\r\n}\r\n","import SpawnEntityCommand from '../commands/spawn-entity-command';\r\nimport InputController from './input-controller';\r\nimport app from '../../app';\r\n\r\nexport default class MapInputController extends InputController {\r\n  constructor() {\r\n    super(app.commandQueue);\r\n    this.cursor = app.cursor;\r\n    this.oldMouseX = 0;\r\n    this.oldMouseY = 0;\r\n  }\r\n\r\n  handle() {\r\n    this.mouseX = app.input.activePointer.worldX;\r\n    this.mouseY = app.input.activePointer.worldY;\r\n    this.tileX = app.tileX(this.mouseX);\r\n    this.tileY = app.tileY(this.mouseY);\r\n\r\n    if (this.leftMouseButtonDown) {\r\n      const pine = app.create.pineTree(this.tileX, this.tileY);\r\n\r\n      if (pine.canSpawnAt(this.tileX, this.tileY)) {\r\n        const command = new SpawnEntityCommand(pine);\r\n        this.queueCommand(command);\r\n      } else {\r\n        pine.destroy();\r\n      }\r\n    }\r\n\r\n    if (this.rightMouseButtonDown) {\r\n      console.log('rmb');\r\n    }\r\n\r\n    this.oldMouseX = this.mouseX;\r\n    this.oldMouseY = this.mouseY;\r\n  }\r\n\r\n  get mousePositionChanged() {\r\n    return this.oldMouseX != this.mouseX || this.oldMouseY != this.mouseY;\r\n  }\r\n\r\n  get leftMouseButtonDown() {\r\n    return app.input.mousePointer.leftButton.isDown\r\n  }\r\n\r\n  get rightMouseButtonDown() {\r\n    return app.input.mousePointer.rightButton.isDown\r\n  }\r\n}\r\n","import Tile from './tile';\r\n\r\nPhaser.Tile = Tile;\r\n","export default class Tile extends Phaser.Tile {\r\n  /**\r\n   * Get binary sum of all neighbors.\r\n   */\r\n  binarySum(test) {\r\n    let sum = 0;\r\n    let multiplier = 256;\r\n\r\n    for (let i = -1; i <= 1; i++) {\r\n      const y = this.y - i;\r\n      const row = this.layer.data[y];\r\n\r\n      for (let j = -1; j <= 1; j++) {\r\n        if (i === 0 && j === 0) continue;\r\n        const x = this.x - j;\r\n        const tile = row && x in row ? row[x] : null;\r\n\r\n        if (test(tile)) sum += multiplier;\r\n\r\n        multiplier /= 2;\r\n      }\r\n    }\r\n\r\n    return sum;\r\n  }\r\n\r\n  /**\r\n   * Get binary sum of neighbors only taking into account\r\n   * the top, left, right, and bottom tiles.\r\n   */\r\n  binarySumSimple(test) {\r\n    let sum = 0;\r\n\r\n    const getNeighbor = (x, y) => {\r\n      if (y in this.layer.data) {\r\n        if (x in this.layer.data[y]) return this.layer.data[x][y];\r\n      }\r\n      return null;\r\n    };\r\n\r\n    const top = getNeighbor(this.y - 1, this.x);\r\n    const left = getNeighbor(this.y, this.x - 1);\r\n    const right = getNeighbor(this.y, this.x + 1);\r\n    const bottom = getNeighbor(this.y + 1, this.x);\r\n\r\n    if (test(top)) sum += 4;\r\n    if (test(left)) sum += 16;\r\n    if (test(right)) sum += 32;\r\n    if (test(bottom)) sum += 128;\r\n\r\n    return sum;\r\n  }\r\n\r\n  /**\r\n   * Boolean check if this tile exists on the layer boundary\r\n   */\r\n  atBoundary() {\r\n    return this.x === 0\r\n      || this.y === 0\r\n      || this.x === this.layer.width - 1\r\n      || this.y === this.layer.height - 1;\r\n  }\r\n}\r\n","import app from '../app';\r\n\r\nexport default class Map {\r\n  constructor(level) {\r\n    this.tilemap = app.game.add.tilemap(level);\r\n    this.tilemap.addTilesetImage('terrain', 'terrain');\r\n\r\n    this.background = this.tilemap.createLayer('background');\n\n    this.static = app.game.add.group();\r\n  }\r\n}\r\n","import app from '../app';\r\nimport entities from '../entities';\r\n\r\nexport default class Game extends Phaser.State {\r\n  create() {\r\n    app.init(this.game);\r\n\r\n    const tree1 = app\r\n      .create\r\n      .pineTree(8, 4)\r\n      .spawn();\r\n\r\n    const tree2 = app\r\n      .create\r\n      .pineTree(6, 5)\r\n      .spawn();\r\n  }\r\n\r\n  update() {\r\n    app.update();\r\n  }\r\n};\r\n","export default class Loading extends Phaser.State {\r\n  preload() {\r\n    this.game.stage.smoothed = false;\r\n    this.loadingBar = this.game.add.sprite(this.game.world.centerX, this.game.world.centerY + 128, 'loading-bar');\r\n    this.loadingBar.anchor.setTo(0.5);\r\n    this.load.setPreloadSprite(this.loadingBar);\r\n\r\n    this.load.image('ground', 'img/ground.png');\r\n    this.load.image('terrain', 'img/terrain-16.png');\r\n    this.load.image('wall', 'img/walls.png');\r\n    this.load.image('tower', 'img/tower.png');\r\n    this.load.image('flag', 'img/flag.png');\r\n    this.load.image('shrub', 'img/shrub.png');\r\n    this.load.image('pine-tree', 'img/pine-tree.png');\r\n\r\n    this.load.tilemap('island', 'maps/island.json', null, Phaser.Tilemap.TILED_JSON);\r\n    this.load.tilemap('crazytown', 'maps/crazytown.json', null, Phaser.Tilemap.TILED_JSON);\r\n    this.load.tilemap('tiny', 'maps/tiny.json', null, Phaser.Tilemap.TILED_JSON);\r\n    this.load.tilemap('paradise', 'maps/paradise.json', null, Phaser.Tilemap.TILED_JSON);\r\n\r\n    this.load.spritesheet('cursor', 'img/cursor.png', 16, 16);\r\n    this.load.atlas('walls', 'img/walls.png', 'atlas/walls.json');\r\n    this.load.atlas('interior', 'img/interior-orange.png', 'atlas/interior.json');\r\n  }\r\n\r\n  create() {\r\n    this.game.stage.smoothed = false;\r\n    this.stage.backgroundColor = '#306082';\r\n    this.state.start('Game');\r\n  }\r\n};\r\n","export default class Preload extends Phaser.State {\r\n  preload() {\r\n    this.game.load.image('loading-bar', 'img/loading-bar.png');\r\n  }\r\n\r\n  create() {\r\n    this.game.stage.backgroundColor = '#306082';\r\n    this.game.scale.scaleMode = Phaser.ScaleManager.USER_SCALE;\r\n    this.game.scale.setUserScale(2, 2);\r\n\r\n    this.game.renderer.renderSession.roundPixels = true;\r\n    Phaser.Canvas.setImageRenderingCrisp(this.game.canvas);\r\n\r\n    this.state.start('Loading');\r\n  }\r\n};\r\n","import geotic from 'geotic';\r\nimport app from '../app';\r\n\r\nexport default class BoundsSystem {\r\n  constructor() {\r\n    this.debug = false;\r\n  }\r\n\r\n  update() {\r\n    const actors = geotic.findByComponent('bounds');\r\n\r\n    if (this.debug) {\r\n      actors.forEach(actor => {\r\n        actor.bounds.debug();\r\n      });\r\n    } else {\r\n      app.game.debug.reset();\r\n    }\r\n  }\r\n}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvZ2VvdGljL2J1aWxkL2dlb3RpYy5qcyIsInNyY1xcYXBwLmpzIiwic3JjXFxib290LmpzIiwic3JjXFxjb21wb25lbnRzXFxib3VuZHMuanMiLCJzcmNcXGNvbXBvbmVudHNcXGluZGV4LmpzIiwic3JjXFxjb21wb25lbnRzXFxwb3NpdGlvbi1ib3VuZC1zcHJpdGUuanMiLCJzcmNcXGNvbXBvbmVudHNcXHBvc2l0aW9uLmpzIiwic3JjXFxjb21wb25lbnRzXFxyZW5kZXJhYmxlLmpzIiwic3JjXFxjb21wb25lbnRzXFxzcGF3bmFibGUuanMiLCJzcmNcXGNvbXBvbmVudHNcXHNwcml0ZS5qcyIsInNyY1xcZW50aXRpZXNcXGVudGl0eS1mYWN0b3J5LmpzIiwic3JjXFxlbnRpdGllc1xcaW5kZXguanMiLCJzcmNcXGVudGl0aWVzXFxwaW5lLXRyZWUuanMiLCJzcmNcXGVudGl0aWVzXFxzaHJ1Yi5qcyIsInNyY1xcZW50aXRpZXNcXHRvd2VyLmpzIiwic3JjXFxpbnB1dFxcY29tbWFuZC1xdWV1ZS5qcyIsInNyY1xcaW5wdXRcXGNvbW1hbmRzXFxjb21tYW5kLmpzIiwic3JjXFxpbnB1dFxcY29tbWFuZHNcXHNwYXduLWVudGl0eS1jb21tYW5kLmpzIiwic3JjXFxpbnB1dFxcY29udHJvbGxlcnNcXGlucHV0LWNvbnRyb2xsZXIuanMiLCJzcmNcXGlucHV0XFxjb250cm9sbGVyc1xcbWFwLWlucHV0LWNvbnRyb2xsZXIuanMiLCJzcmNcXHBoYXNlclxcYm9vdHN0cmFwLmpzIiwic3JjXFxwaGFzZXJcXHRpbGUuanMiLCJzcmNcXHByZWZhYnNcXG1hcC5qcyIsInNyY1xcc3RhdGVzXFxnYW1lLmpzIiwic3JjXFxzdGF0ZXNcXGxvYWRpbmcuanMiLCJzcmNcXHN0YXRlc1xccHJlbG9hZC5qcyIsInNyY1xcc3lzdGVtc1xcYm91bmRzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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Qzs7QUFFQSxXQUFLLElBQUwsQ0FBVSxRQUFWLENBQW1CLGFBQW5CLENBQWlDLFdBQWpDLEdBQStDLElBQS9DO0FBQ0EsYUFBTyxNQUFQLENBQWMsc0JBQWQsQ0FBcUMsS0FBSyxJQUFMLENBQVUsTUFBL0M7O0FBRUEsV0FBSyxLQUFMLENBQVcsS0FBWCxDQUFpQixTQUFqQjtBQUNEOzs7O0VBZGtDLE9BQU8sSzs7a0JBQXZCLE87QUFlcEI7Ozs7Ozs7Ozs7O0FDZkQ7Ozs7QUFDQTs7Ozs7Ozs7SUFFcUIsWTtBQUNuQiwwQkFBYztBQUFBOztBQUNaLFNBQUssS0FBTCxHQUFhLEtBQWI7QUFDRDs7Ozs2QkFFUTtBQUNQLFVBQU0sU0FBUyxpQkFBTyxlQUFQLENBQXVCLFFBQXZCLENBQWY7O0FBRUEsVUFBSSxLQUFLLEtBQVQsRUFBZ0I7QUFDZCxlQUFPLE9BQVAsQ0FBZSxpQkFBUztBQUN0QixnQkFBTSxNQUFOLENBQWEsS0FBYjtBQUNELFNBRkQ7QUFHRCxPQUpELE1BSU87QUFDTCxzQkFBSSxJQUFKLENBQVMsS0FBVCxDQUFlLEtBQWY7QUFDRDtBQUNGOzs7Ozs7a0JBZmtCLFkiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikgeyBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSB7IGZvciAodmFyIGkgPSAwLCBhcnIyID0gQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsgYXJyMltpXSA9IGFycltpXTsgfSByZXR1cm4gYXJyMjsgfSBlbHNlIHsgcmV0dXJuIEFycmF5LmZyb20oYXJyKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIF9pZCA9IDA7XG52YXIgaWQgPSBmdW5jdGlvbiBpZCgpIHtcbiAgcmV0dXJuICsrX2lkO1xufTtcblxudmFyIGhhc2ggPSBmdW5jdGlvbiBoYXNoKG4pIHtcbiAgcmV0dXJuIG4uc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBhID4gYjtcbiAgfSkuam9pbignJCcpO1xufTtcbnZhciByZW1vdmUgPSBmdW5jdGlvbiByZW1vdmUoYSwgdikge1xuICByZXR1cm4gYS5zcGxpY2UoYS5pbmRleE9mKHYpLCAxKTtcbn07XG52YXIgZ2V0Q29tcG9uZW50ID0gZnVuY3Rpb24gZ2V0Q29tcG9uZW50KG4pIHtcbiAgcmV0dXJuIGNvbXBvbmVudHMuZ2V0KG4pIHx8IG5ld0NvbXBvbmVudChuKTtcbn07XG52YXIgY2xvbmUgPSBmdW5jdGlvbiBjbG9uZShvKSB7XG4gIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG8pKTtcbn07XG52YXIgc2lncyA9IG5ldyBNYXAoKTtcbnZhciB0c2lncyA9IG5ldyBNYXAoKTtcbnZhciB0YWdzID0gbmV3IE1hcCgpO1xudmFyIGVudGl0aWVzID0gW107XG52YXIgY29tcG9uZW50cyA9IG5ldyBNYXAoKTtcblxudmFyIFNpZ25hdHVyZSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gU2lnbmF0dXJlKG4pIHtcbiAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNpZ25hdHVyZSk7XG5cbiAgICB0aGlzLm5hID0gbjtcbiAgICB0aGlzLmVuID0gW107XG4gICAgZW50aXRpZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgcmV0dXJuIF90aGlzLm9uQWRkKGUpO1xuICAgIH0pO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKFNpZ25hdHVyZSwgW3tcbiAgICBrZXk6ICdtYXRjaCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG1hdGNoKGUpIHtcbiAgICAgIHZhciBrID0gT2JqZWN0LmtleXMoZS5jb21wb25lbnRzKTtcbiAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTtcbiAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkO1xuXG4gICAgICB0cnkge1xuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLm5hW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkge1xuICAgICAgICAgIHZhciBuID0gX3N0ZXAudmFsdWU7XG5cbiAgICAgICAgICBpZiAoIWsuaW5jbHVkZXMobikpIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTtcbiAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuKSB7XG4gICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ29uQWRkJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gb25BZGQoZSkge1xuICAgICAgaWYgKHRoaXMuZW4uaW5jbHVkZXMoZSkpIHJldHVybjtcbiAgICAgIHRoaXMubWF0Y2goZSkgJiYgdGhpcy5lbi5wdXNoKGUpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ29uUmVtJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gb25SZW0oZSwgYykge1xuICAgICAgdGhpcy5uYS5pbmNsdWRlcyhjKSAmJiByZW1vdmUodGhpcy5lbiwgZSk7XG4gICAgfVxuICB9XSwgW3tcbiAgICBrZXk6ICdnZXQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQobikge1xuICAgICAgdmFyIGggPSBoYXNoKG4pO1xuICAgICAgcmV0dXJuIHNpZ3MuaGFzKGgpID8gc2lncy5nZXQoaCkgOiBTaWduYXR1cmUubWFrZShuLCBoKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdtYWtlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbWFrZShuLCBoKSB7XG4gICAgICB2YXIgdCA9IG5ldyBTaWduYXR1cmUobik7XG4gICAgICBzaWdzLnNldChoLCB0KTtcbiAgICAgIHJldHVybiB0O1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBTaWduYXR1cmU7XG59KCk7XG5cbnZhciBUYWdTaWduYXR1cmUgPSBmdW5jdGlvbiAoX1NpZ25hdHVyZSkge1xuICBfaW5oZXJpdHMoVGFnU2lnbmF0dXJlLCBfU2lnbmF0dXJlKTtcblxuICBmdW5jdGlvbiBUYWdTaWduYXR1cmUoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRhZ1NpZ25hdHVyZSk7XG5cbiAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFRhZ1NpZ25hdHVyZSkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoVGFnU2lnbmF0dXJlLCBbe1xuICAgIGtleTogJ21hdGNoJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbWF0Y2goZSkge1xuICAgICAgdmFyIGsgPSBPYmplY3Qua2V5cyhlLnRhZ3MpO1xuICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTtcbiAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvcjIgPSBmYWxzZTtcbiAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjIgPSB1bmRlZmluZWQ7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB0aGlzLm5hW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXAyOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gKF9zdGVwMiA9IF9pdGVyYXRvcjIubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlKSB7XG4gICAgICAgICAgdmFyIG4gPSBfc3RlcDIudmFsdWU7XG5cbiAgICAgICAgICBpZiAoIWsuaW5jbHVkZXMobikpIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IHRydWU7XG4gICAgICAgIF9pdGVyYXRvckVycm9yMiA9IGVycjtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiAmJiBfaXRlcmF0b3IyLnJldHVybikge1xuICAgICAgICAgICAgX2l0ZXJhdG9yMi5yZXR1cm4oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yMikge1xuICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IyO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmVuLnB1c2goZSk7XG4gICAgfVxuICB9XSwgW3tcbiAgICBrZXk6ICdnZXQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQobikge1xuICAgICAgdmFyIGggPSBoYXNoKG4pO1xuICAgICAgcmV0dXJuIHRzaWdzLmhhcyhoKSA/IHRzaWdzLmdldChoKSA6IFRhZ1NpZ25hdHVyZS5tYWtlKG4sIGgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ21ha2UnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBtYWtlKG4sIGgpIHtcbiAgICAgIHZhciB0ID0gbmV3IFRhZ1NpZ25hdHVyZShuKTtcbiAgICAgIHRzaWdzLnNldChoLCB0KTtcbiAgICAgIHJldHVybiB0O1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBUYWdTaWduYXR1cmU7XG59KFNpZ25hdHVyZSk7XG5cbnZhciByZXNlcnZlID0gWydpZCcsICdsaXN0ZW5lcnMnLCAnc2VyaWFsaXplJywgJ2Rlc2VyaWFsaXplJywgJ2FkZCcsICdyZW1vdmUnLCAnaGFzJywgJ2Rlc3Ryb3knLCAndGFnJywgJ3RhZ3MnLCAndW50YWcnLCAnY29tcG9uZW50cycsICdvbicsICdvZmYnLCAnb25jZScsICdlbWl0J107XG5cbnZhciBFbnRpdHkgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEVudGl0eShpZCkge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFbnRpdHkpO1xuXG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMudGFncyA9IHt9O1xuICAgIHRoaXMubGlzdGVuZXJzID0gbmV3IE1hcCgpO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEVudGl0eSwgW3tcbiAgICBrZXk6ICdzZXJpYWxpemUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZXJpYWxpemUoKSB7XG4gICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHRoaXMuaWQsXG4gICAgICAgIHRhZ3M6IE9iamVjdC5rZXlzKHRoaXMudCksXG4gICAgICAgIGNvbXBvbmVudHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2YXIgcyA9IFtdO1xuICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7XG4gICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMyA9IGZhbHNlO1xuICAgICAgICAgIHZhciBfaXRlcmF0b3JFcnJvcjMgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IE9iamVjdC5rZXlzKF90aGlzMy5jb21wb25lbnRzKVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkge1xuICAgICAgICAgICAgICB2YXIgbiA9IF9zdGVwMy52YWx1ZTtcblxuICAgICAgICAgICAgICBzLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IG4sXG4gICAgICAgICAgICAgICAgdmFsdWU6IF90aGlzM1tuXS5zZXJpYWxpemUgPyBfdGhpczNbbl0uc2VyaWFsaXplKCkgOiBjbG9uZShfdGhpczNbbl0pXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IzID0gdHJ1ZTtcbiAgICAgICAgICAgIF9pdGVyYXRvckVycm9yMyA9IGVycjtcbiAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyAmJiBfaXRlcmF0b3IzLnJldHVybikge1xuICAgICAgICAgICAgICAgIF9pdGVyYXRvcjMucmV0dXJuKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjM7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4gcztcbiAgICAgICAgfSgpXG4gICAgICB9O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2FkZCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGFkZChuKSB7XG4gICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYSA9IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgICAgYVtfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgICB9XG5cbiAgICAgIGF0dGFjaFRvKHRoaXMsIG4sIGdldENvbXBvbmVudChuKS5hcHBseSh1bmRlZmluZWQsIFt0aGlzXS5jb25jYXQoYSkpKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3JlbW92ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZShuKSB7XG4gICAgICB2YXIgX24sXG4gICAgICAgICAgX3RoaXM0ID0gdGhpcztcblxuICAgICAgaWYgKCF0aGlzW25dKSByZXR1cm47XG5cbiAgICAgIGZvciAodmFyIF9sZW4yID0gYXJndW1lbnRzLmxlbmd0aCwgYSA9IEFycmF5KF9sZW4yID4gMSA/IF9sZW4yIC0gMSA6IDApLCBfa2V5MiA9IDE7IF9rZXkyIDwgX2xlbjI7IF9rZXkyKyspIHtcbiAgICAgICAgYVtfa2V5MiAtIDFdID0gYXJndW1lbnRzW19rZXkyXTtcbiAgICAgIH1cblxuICAgICAgdGhpc1tuXS51bm1vdW50ICYmIChfbiA9IHRoaXNbbl0pLnVubW91bnQuYXBwbHkoX24sIFt0aGlzXS5jb25jYXQoYSkpO1xuICAgICAgZGVsZXRlIHRoaXNbbl07XG4gICAgICBzaWdzLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIHQub25SZW0oX3RoaXM0LCBuKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnbWFuZGF0ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG1hbmRhdGUobikge1xuICAgICAgZm9yICh2YXIgX2xlbjMgPSBhcmd1bWVudHMubGVuZ3RoLCBhID0gQXJyYXkoX2xlbjMgPiAxID8gX2xlbjMgLSAxIDogMCksIF9rZXkzID0gMTsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykge1xuICAgICAgICBhW19rZXkzIC0gMV0gPSBhcmd1bWVudHNbX2tleTNdO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXNbbl0pIHRoaXMuYWRkLmFwcGx5KHRoaXMsIFtuXS5jb25jYXQoYSkpO1xuICAgICAgcmV0dXJuIHRoaXNbbl07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnaGFzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGFzKG4pIHtcbiAgICAgIHJldHVybiAhIXRoaXNbbl07XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnZGVzdHJveScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICBfZGVzdHJveSh0aGlzKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd0YWcnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiB0YWcobikge1xuICAgICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICAgIHZhciBhID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8ge30gOiBhcmd1bWVudHNbMV07XG5cbiAgICAgIHZhciB0ID0gZ2V0VGFnKG4pO1xuICAgICAgT2JqZWN0LmFzc2lnbih0LCBhKTtcbiAgICAgIGlmIChuIGluIHRoaXMudGFncykgcmV0dXJuIHRoaXM7XG4gICAgICB0aGlzLnRhZ3Nbbl0gPSB0O1xuICAgICAgdHNpZ3MuZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICByZXR1cm4gdC5vbkFkZChfdGhpczUpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd1bnRhZycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVudGFnKG4pIHtcbiAgICAgIHZhciBfdGhpczYgPSB0aGlzO1xuXG4gICAgICBpZiAoIXRoaXMudGFnc1tuXSkgcmV0dXJuO1xuICAgICAgZGVsZXRlIHRoaXMudGFnc1tuXTtcbiAgICAgIHRzaWdzLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIHQub25SZW0oX3RoaXM2LCBuKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnb24nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvbihlLCBmKSB7XG4gICAgICB0aGlzLmxpc3RlbmVycy5oYXMoZSkgfHwgdGhpcy5saXN0ZW5lcnMuc2V0KGUsIFtdKTtcbiAgICAgIHRoaXMubGlzdGVuZXJzLmdldChlKS5wdXNoKGYpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnb25jZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG9uY2UoZSwgZikge1xuICAgICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICAgIHZhciBmbiA9IGZ1bmN0aW9uIGZuKCkge1xuICAgICAgICBfdGhpczcub2ZmKGUsIGYpO1xuICAgICAgICBmLmFwcGx5KHVuZGVmaW5lZCwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgICBmbi5fID0gZjtcbiAgICAgIHJldHVybiB0aGlzLm9uKGUsIGZuKTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdvZmYnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZSwgZikge1xuICAgICAgdmFyIGxzID0gdGhpcy5saXN0ZW5lcnMuZ2V0KGUpO1xuICAgICAgaWYgKGxzICYmIGxzLmxlbmd0aCkge1xuICAgICAgICBscy5mb3JFYWNoKGZ1bmN0aW9uIChsLCBpKSB7XG4gICAgICAgICAgaWYgKGwgPT09IGYgfHwgbC5fID09PSBmKSB7XG4gICAgICAgICAgICBscy5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgbHMubGVuZ3RoID8gdGhpcy5saXN0ZW5lcnMuc2V0KGUsIGxzKSA6IHRoaXMubGlzdGVuZXJzLmRlbGV0ZShlKTtcblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnZW1pdCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGVtaXQoZSkge1xuICAgICAgZm9yICh2YXIgX2xlbjQgPSBhcmd1bWVudHMubGVuZ3RoLCBhID0gQXJyYXkoX2xlbjQgPiAxID8gX2xlbjQgLSAxIDogMCksIF9rZXk0ID0gMTsgX2tleTQgPCBfbGVuNDsgX2tleTQrKykge1xuICAgICAgICBhW19rZXk0IC0gMV0gPSBhcmd1bWVudHNbX2tleTRdO1xuICAgICAgfVxuXG4gICAgICB2YXIgbHMgPSB0aGlzLmxpc3RlbmVycy5nZXQoZSk7XG4gICAgICBpZiAobHMgJiYgbHMubGVuZ3RoKSB7XG4gICAgICAgIGxzLmZvckVhY2goZnVuY3Rpb24gKGwpIHtcbiAgICAgICAgICByZXR1cm4gbC5hcHBseSh1bmRlZmluZWQsIGEpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2NvbXBvbmVudHMnLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgICAgIHZhciBjID0ge307XG4gICAgICBPYmplY3Qua2V5cyh0aGlzKS5maWx0ZXIoZnVuY3Rpb24gKGspIHtcbiAgICAgICAgcmV0dXJuICFyZXNlcnZlLmluY2x1ZGVzKGspO1xuICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoaykge1xuICAgICAgICByZXR1cm4gY1trXSA9IF90aGlzOFtrXTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGM7XG4gICAgfVxuICB9XSwgW3tcbiAgICBrZXk6ICdkZXNlcmlhbGl6ZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGRlc2VyaWFsaXplKGQpIHtcbiAgICAgIHZhciBlID0gZW50aXR5KGQuaWQpO1xuICAgICAgZC50YWdzLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgcmV0dXJuIGUudGFnKHQpO1xuICAgICAgfSk7XG4gICAgICBkLmNvbXBvbmVudHMuZm9yRWFjaChmdW5jdGlvbiAoYykge1xuICAgICAgICB2YXIgbSA9IGdldENvbXBvbmVudChjLm5hbWUpO1xuICAgICAgICBpZiAobS5kZXNlcmlhbGl6ZSkge1xuICAgICAgICAgIGF0dGFjaFRvKGUsIGMubmFtZSwgbS5kZXNlcmlhbGl6ZShlLCBjLnZhbHVlKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKF90eXBlb2YoYy52YWx1ZSkgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBhdHRhY2hUbyhlLCBjLm5hbWUsIGMudmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICB2YXIgaW5zID0gbShlKSB8fCB7fTtcbiAgICAgICAgICBPYmplY3QuYXNzaWduKGlucywgYy52YWx1ZSk7XG4gICAgICAgICAgYXR0YWNoVG8oZSwgYy5uYW1lLCBpbnMpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gRW50aXR5O1xufSgpO1xuXG52YXIgYXR0YWNoVG8gPSBmdW5jdGlvbiBhdHRhY2hUbyhlLCBuLCBjKSB7XG4gIGVbbl0gPSBjO1xuICBjLm1vdW50ICYmIGMubW91bnQoZSk7XG4gIHNpZ3MuZm9yRWFjaChmdW5jdGlvbiAocykge1xuICAgIHJldHVybiBzLm9uQWRkKGUpO1xuICB9KTtcbn07XG5cbnZhciBuZXdDb21wb25lbnQgPSBmdW5jdGlvbiBuZXdDb21wb25lbnQobikge1xuICB2YXIgYyA9IGZ1bmN0aW9uIGMoZW50aXR5KSB7fTtcbiAgY29tcG9uZW50cy5zZXQobiwgYyk7XG4gIHJldHVybiBjO1xufTtcblxudmFyIG5ld1RhZyA9IGZ1bmN0aW9uIG5ld1RhZyhuKSB7XG4gIHZhciB0ID0ge307XG4gIHRhZ3Muc2V0KG4sIHQpO1xuICByZXR1cm4gdDtcbn07XG5cbnZhciBzelRhZ3MgPSBmdW5jdGlvbiBzelRhZ3MoKSB7XG4gIHJldHVybiBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRhZ3MpKS5tYXAoZnVuY3Rpb24gKHYpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdlswXSxcbiAgICAgIHZhbHVlOiB2WzFdLnNlcmlhbGl6ZSA/IHZbMV0uc2VyaWFsaXplKCkgOiBjbG9uZSh2WzFdKVxuICAgIH07XG4gIH0pO1xufTtcblxudmFyIHN6RW50cyA9IGZ1bmN0aW9uIHN6RW50cygpIHtcbiAgcmV0dXJuIGVudGl0aWVzLm1hcChmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBlLnNlcmlhbGl6ZSgpO1xuICB9KTtcbn07XG52YXIgZ2V0VGFnID0gZXhwb3J0cy5nZXRUYWcgPSBmdW5jdGlvbiBnZXRUYWcobikge1xuICByZXR1cm4gdGFncy5nZXQobikgfHwgbmV3VGFnKG4pO1xufTtcbnZhciBjb21wb25lbnQgPSBleHBvcnRzLmNvbXBvbmVudCA9IGZ1bmN0aW9uIGNvbXBvbmVudChuLCBkKSB7XG4gIGlmIChyZXNlcnZlLmluY2x1ZGVzKG4pKSB0aHJvdyAnQ2Fubm90IHVzZSBhIHJlc2VydmVkIGtleXdvcmQgYXMgYSBjb21wb25lbnQnO1xuICBjb21wb25lbnRzLnNldChuLCBkKTtcbn07XG52YXIgZmluZEJ5Q29tcG9uZW50ID0gZXhwb3J0cy5maW5kQnlDb21wb25lbnQgPSBmdW5jdGlvbiBmaW5kQnlDb21wb25lbnQoKSB7XG4gIGZvciAodmFyIF9sZW41ID0gYXJndW1lbnRzLmxlbmd0aCwgbiA9IEFycmF5KF9sZW41KSwgX2tleTUgPSAwOyBfa2V5NSA8IF9sZW41OyBfa2V5NSsrKSB7XG4gICAgbltfa2V5NV0gPSBhcmd1bWVudHNbX2tleTVdO1xuICB9XG5cbiAgcmV0dXJuIFNpZ25hdHVyZS5nZXQobikuZW47XG59O1xudmFyIGZpbmRCeVRhZyA9IGV4cG9ydHMuZmluZEJ5VGFnID0gZnVuY3Rpb24gZmluZEJ5VGFnKCkge1xuICBmb3IgKHZhciBfbGVuNiA9IGFyZ3VtZW50cy5sZW5ndGgsIG4gPSBBcnJheShfbGVuNiksIF9rZXk2ID0gMDsgX2tleTYgPCBfbGVuNjsgX2tleTYrKykge1xuICAgIG5bX2tleTZdID0gYXJndW1lbnRzW19rZXk2XTtcbiAgfVxuXG4gIHJldHVybiBUYWdTaWduYXR1cmUuZ2V0KG4pLmVuO1xufTtcbnZhciBmaW5kQnlJZCA9IGV4cG9ydHMuZmluZEJ5SWQgPSBmdW5jdGlvbiBmaW5kQnlJZChpZCkge1xuICByZXR1cm4gZW50aXRpZXMuZmluZChmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBlLmlkID09PSBpZDtcbiAgfSk7XG59O1xudmFyIHNlcmlhbGl6ZSA9IGV4cG9ydHMuc2VyaWFsaXplID0gZnVuY3Rpb24gc2VyaWFsaXplKCkge1xuICByZXR1cm4geyB0YWdzOiBzelRhZ3MoKSwgZW50aXRpZXM6IHN6RW50cygpIH07XG59O1xudmFyIGVudGl0eSA9IGV4cG9ydHMuZW50aXR5ID0gZnVuY3Rpb24gZW50aXR5KCkge1xuICB2YXIgaSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzBdO1xuXG4gIHZhciBlID0gbmV3IEVudGl0eShpIHx8IGlkKCkpO1xuICBlbnRpdGllcy5wdXNoKGUpO1xuICBzaWdzLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICByZXR1cm4gdC5tYXRjaChlKTtcbiAgfSk7XG4gIHJldHVybiBlO1xufTtcblxudmFyIGRlc2VyaWFsaXplID0gZXhwb3J0cy5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uIGRlc2VyaWFsaXplKGRhdGEpIHtcbiAgZGF0YS50YWdzLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihnZXRUYWcodC5uYW1lKSwgdC52YWx1ZSk7XG4gIH0pO1xuICBkYXRhLmVudGl0aWVzLmZvckVhY2goZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gRW50aXR5LmRlc2VyaWFsaXplKGUpO1xuICB9KTtcbn07XG5cbnZhciBfZGVzdHJveSA9IGZ1bmN0aW9uIF9kZXN0cm95KGUpIHtcbiAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ID0gdHJ1ZTtcbiAgdmFyIF9kaWRJdGVyYXRvckVycm9yNCA9IGZhbHNlO1xuICB2YXIgX2l0ZXJhdG9yRXJyb3I0ID0gdW5kZWZpbmVkO1xuXG4gIHRyeSB7XG4gICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IE9iamVjdC5rZXlzKGUuY29tcG9uZW50cylbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDQ7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQgPSAoX3N0ZXA0ID0gX2l0ZXJhdG9yNC5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IHRydWUpIHtcbiAgICAgIHZhciBuID0gX3N0ZXA0LnZhbHVlO1xuICAgICAgZS5yZW1vdmUobik7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBfZGlkSXRlcmF0b3JFcnJvcjQgPSB0cnVlO1xuICAgIF9pdGVyYXRvckVycm9yNCA9IGVycjtcbiAgfSBmaW5hbGx5IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCAmJiBfaXRlcmF0b3I0LnJldHVybikge1xuICAgICAgICBfaXRlcmF0b3I0LnJldHVybigpO1xuICAgICAgfVxuICAgIH0gZmluYWxseSB7XG4gICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3I0KSB7XG4gICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yNDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgPSB0cnVlO1xuICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3I1ID0gZmFsc2U7XG4gIHZhciBfaXRlcmF0b3JFcnJvcjUgPSB1bmRlZmluZWQ7XG5cbiAgdHJ5IHtcbiAgICBmb3IgKHZhciBfaXRlcmF0b3I1ID0gT2JqZWN0LmtleXMoZS50YWdzKVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwNTsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNSA9IChfc3RlcDUgPSBfaXRlcmF0b3I1Lm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb241ID0gdHJ1ZSkge1xuICAgICAgdmFyIHQgPSBfc3RlcDUudmFsdWU7XG4gICAgICBlLnVudGFnKHQpO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgX2RpZEl0ZXJhdG9yRXJyb3I1ID0gdHJ1ZTtcbiAgICBfaXRlcmF0b3JFcnJvcjUgPSBlcnI7XG4gIH0gZmluYWxseSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjUgJiYgX2l0ZXJhdG9yNS5yZXR1cm4pIHtcbiAgICAgICAgX2l0ZXJhdG9yNS5yZXR1cm4oKTtcbiAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yNSkge1xuICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjU7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlKGVudGl0aWVzLCBlKTtcbn07XG5cbmV4cG9ydHMuZGVzdHJveSA9IF9kZXN0cm95O1xudmFyIGNsZWFyID0gZXhwb3J0cy5jbGVhciA9IGZ1bmN0aW9uIGNsZWFyKCkge1xuICBlbnRpdGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGUuZGVzdHJveSgpO1xuICB9KTtcbiAgc2lncyA9IG5ldyBNYXAoKTtcbiAgdHNpZ3MgPSBuZXcgTWFwKCk7XG4gIHRhZ3MgPSBuZXcgTWFwKCk7XG4gIGVudGl0aWVzID0gW107XG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSB7XG4gIGNsZWFyOiBjbGVhcixcbiAgZW50aXR5OiBlbnRpdHksXG4gIGdldFRhZzogZ2V0VGFnLFxuICBkZXN0cm95OiBfZGVzdHJveSxcbiAgZmluZEJ5SWQ6IGZpbmRCeUlkLFxuICBmaW5kQnlUYWc6IGZpbmRCeVRhZyxcbiAgc2VyaWFsaXplOiBzZXJpYWxpemUsXG4gIGRlc2VyaWFsaXplOiBkZXNlcmlhbGl6ZSxcbiAgY29tcG9uZW50OiBjb21wb25lbnQsXG4gIGZpbmRCeUNvbXBvbmVudDogZmluZEJ5Q29tcG9uZW50XG59OyIsImltcG9ydCBFbnRpdHlGYWN0b3J5IGZyb20gJy4vZW50aXRpZXMvZW50aXR5LWZhY3RvcnknO1xyXG5pbXBvcnQgQ29tbWFuZFF1ZXVlIGZyb20gJy4vaW5wdXQvY29tbWFuZC1xdWV1ZSc7XHJcbmltcG9ydCBNYXBJbnB1dENvbnRyb2xsZXIgZnJvbSAnLi9pbnB1dC9jb250cm9sbGVycy9tYXAtaW5wdXQtY29udHJvbGxlcic7XHJcbmltcG9ydCBNYXAgZnJvbSAnLi9wcmVmYWJzL21hcCc7XHJcbmltcG9ydCBCb3VuZHNTeXN0ZW0gZnJvbSAnLi9zeXN0ZW1zL2JvdW5kcyc7XHJcblxyXG5jbGFzcyBBcHAge1xyXG4gIGluaXQoZ2FtZSkge1xyXG4gICAgdGhpcy5nYW1lID0gZ2FtZTtcclxuICAgIHRoaXMuaW5wdXQgPSB0aGlzLmdhbWUuaW5wdXQ7XHJcbiAgICB0aGlzLmNyZWF0ZSA9IG5ldyBFbnRpdHlGYWN0b3J5O1xyXG4gICAgdGhpcy5tYXAgPSBuZXcgTWFwKCdwYXJhZGlzZScpO1xyXG4gICAgdGhpcy5jb21tYW5kUXVldWUgPSBuZXcgQ29tbWFuZFF1ZXVlKCk7XHJcbiAgICB0aGlzLmlucHV0Q29udHJvbGxlciA9IG5ldyBNYXBJbnB1dENvbnRyb2xsZXIoKTtcclxuICAgIHRoaXMuc3lzdGVtcyA9IHtcclxuICAgICAgYm91bmRzOiBuZXcgQm91bmRzU3lzdGVtLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyB0aGlzLnN5c3RlbXMuYm91bmRzLmRlYnVnID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIGdldCBjb25zdGFudHMoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAnVElMRV9TSVpFJzogMTYsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgd29ybGRYKHgpIHtcclxuICAgIHJldHVybiB4ICogdGhpcy5jb25zdGFudHMuVElMRV9TSVpFO1xyXG4gIH1cclxuXHJcbiAgd29ybGRZKHkpIHtcclxuICAgIHJldHVybiB5ICogdGhpcy5jb25zdGFudHMuVElMRV9TSVpFO1xyXG4gIH1cclxuXHJcbiAgdGlsZVgod29ybGRYKSB7XHJcbiAgICByZXR1cm4gTWF0aC5mbG9vcih3b3JsZFggLyB0aGlzLmNvbnN0YW50cy5USUxFX1NJWkUpO1xyXG4gIH1cclxuXHJcbiAgdGlsZVkod29ybGRZKSB7XHJcbiAgICByZXR1cm4gTWF0aC5mbG9vcih3b3JsZFkgLyB0aGlzLmNvbnN0YW50cy5USUxFX1NJWkUpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlKCkge1xyXG4gICAgdGhpcy5pbnB1dENvbnRyb2xsZXIuaGFuZGxlKCk7XHJcbiAgICB0aGlzLmNvbW1hbmRRdWV1ZS5wcm9jZXNzQWxsKCk7XHJcbiAgICB0aGlzLnN5c3RlbXMuYm91bmRzLnVwZGF0ZSgpO1xyXG4gIH1cclxufTtcclxuXHJcbmxldCBhcHAgPSBuZXcgQXBwO1xyXG5cclxuZXhwb3J0IHsgYXBwIH07XHJcbmV4cG9ydCBkZWZhdWx0IGFwcDtcclxuIiwiaW1wb3J0ICcuL3BoYXNlci9ib290c3RyYXAnO1xyXG5pbXBvcnQgUHJlbG9hZCBmcm9tICcuL3N0YXRlcy9wcmVsb2FkJztcclxuaW1wb3J0IExvYWRpbmcgZnJvbSAnLi9zdGF0ZXMvbG9hZGluZyc7XHJcbmltcG9ydCBHYW1lIGZyb20gJy4vc3RhdGVzL2dhbWUnO1xyXG5pbXBvcnQgJy4vY29tcG9uZW50cyc7XHJcbmltcG9ydCAnLi9lbnRpdGllcyc7XHJcblxyXG5jbGFzcyBCb290IGV4dGVuZHMgUGhhc2VyLkdhbWUge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoMTYgKiAxNiwgMTYgKiAxNiwgUGhhc2VyLkFVVE8sICdnYW1lLWNvbnRhaW5lcicsIG51bGwsIGZhbHNlLCBmYWxzZSk7XHJcblxyXG4gICAgdGhpcy5zdGF0ZS5hZGQoJ1ByZWxvYWQnLCBQcmVsb2FkKTtcclxuICAgIHRoaXMuc3RhdGUuYWRkKCdMb2FkaW5nJywgTG9hZGluZyk7XHJcbiAgICB0aGlzLnN0YXRlLmFkZCgnR2FtZScsIEdhbWUpO1xyXG5cclxuICAgIHRoaXMuc3RhdGUuc3RhcnQoJ1ByZWxvYWQnKTtcclxuICB9XHJcbn07XHJcblxyXG5uZXcgQm9vdDtcclxuIiwiaW1wb3J0IHsgY29tcG9uZW50IH0gZnJvbSAnZ2VvdGljJztcclxuaW1wb3J0IGFwcCBmcm9tICcuLi9hcHAnO1xyXG5cclxuY2xhc3MgQm91bmRzIHtcclxuICBjb25zdHJ1Y3Rvcihwb3NpdGlvbiwgd2lkdGggPSAxLCBoZWlnaHQgPSAxLCBvZmZzZXRYID0gMCwgb2Zmc2V0WSA9IDApIHtcclxuICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcclxuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcclxuICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xyXG4gICAgdGhpcy5vZmZzZXRYID0gb2Zmc2V0WDtcclxuICAgIHRoaXMub2Zmc2V0WSA9IG9mZnNldFk7XHJcbiAgfVxyXG5cclxuICBnZXQgd29ybGRYKCkge1xyXG4gICAgcmV0dXJuIGFwcC53b3JsZFgodGhpcy5sZWZ0Qm91bmQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHdvcmxkWSgpIHtcclxuICAgIHJldHVybiBhcHAud29ybGRZKHRoaXMudG9wQm91bmQpO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHdvcmxkV2lkdGgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy53aWR0aCAqIGFwcC5jb25zdGFudHMuVElMRV9TSVpFO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHdvcmxkSGVpZ2h0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuaGVpZ2h0ICogYXBwLmNvbnN0YW50cy5USUxFX1NJWkU7XHJcbiAgfVxyXG5cclxuICBnZXQgbGVmdEJvdW5kKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucG9zaXRpb24ueCArIHRoaXMub2Zmc2V0WDtcclxuICB9XHJcblxyXG4gIGdldCByaWdodEJvdW5kKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucG9zaXRpb24ueCArIHRoaXMud2lkdGggKyB0aGlzLm9mZnNldFg7XHJcbiAgfVxyXG5cclxuICBnZXQgdG9wQm91bmQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wb3NpdGlvbi55ICsgdGhpcy5vZmZzZXRZO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGJvdHRvbUJvdW5kKCkge1xyXG4gICAgcmV0dXJuIHRoaXMucG9zaXRpb24ueSArIHRoaXMuaGVpZ2h0ICsgdGhpcy5vZmZzZXRZO1xyXG4gIH1cclxuXHJcbiAgY29udGFpbnMoeCwgeSkge1xyXG4gICAgcmV0dXJuIHggPiB0aGlzLmxlZnRCb3VuZFxyXG4gICAgICAmJiB4IDwgdGhpcy5yaWdodEJvdW5kXHJcbiAgICAgICYmIHkgPiB0aGlzLnRvcEJvdW5kXHJcbiAgICAgICYmIHkgPCB0aGlzLmJvdHRvbUJvdW5kO1xyXG4gIH1cclxuXHJcbiAgY29sbGlkZXNMZWZ0KG90aGVyKSB7XHJcbiAgICByZXR1cm4gdGhpcy5sZWZ0Qm91bmQgPCBvdGhlci5yaWdodEJvdW5kICYmIHRoaXMubGVmdEJvdW5kID49IG90aGVyLmxlZnRCb3VuZDtcclxuICB9XHJcblxyXG4gIGNvbGxpZGVzUmlnaHQob3RoZXIpIHtcclxuICAgIHJldHVybiB0aGlzLnJpZ2h0Qm91bmQgPiBvdGhlci5sZWZ0Qm91bmQgJiYgdGhpcy5yaWdodEJvdW5kIDw9IG90aGVyLnJpZ2h0Qm91bmQ7XHJcbiAgfVxyXG5cclxuICBjb2xsaWRlc1RvcChvdGhlcikge1xyXG4gICAgcmV0dXJuIHRoaXMudG9wQm91bmQgPCBvdGhlci5ib3R0b21Cb3VuZCAmJiB0aGlzLnRvcEJvdW5kID49IG90aGVyLnRvcEJvdW5kO1xyXG4gIH1cclxuXHJcbiAgY29sbGlkZXNCb3R0b20ob3RoZXIpIHtcclxuICAgIHJldHVybiB0aGlzLmJvdHRvbUJvdW5kID4gb3RoZXIudG9wQm91bmQgJiYgdGhpcy5ib3R0b21Cb3VuZCA8PSBvdGhlci5ib3R0b21Cb3VuZDtcclxuICB9XHJcblxyXG4gIGNvbGxpZGVzV2l0aChvdGhlcikge1xyXG4gICAgcmV0dXJuIChvdGhlciAhPSB0aGlzKVxyXG4gICAgICAmJiAodGhpcy5jb2xsaWRlc0xlZnQob3RoZXIpIHx8IHRoaXMuY29sbGlkZXNSaWdodChvdGhlcikpXHJcbiAgICAgICYmICh0aGlzLmNvbGxpZGVzVG9wKG90aGVyKSB8fCB0aGlzLmNvbGxpZGVzQm90dG9tKG90aGVyKSk7XHJcbiAgfVxyXG5cclxuICBkZWJ1ZygpIHtcclxuICAgIGNvbnN0IHJlY3QgPSBuZXcgUGhhc2VyLlJlY3RhbmdsZShcclxuICAgICAgdGhpcy53b3JsZFgsXHJcbiAgICAgIHRoaXMud29ybGRZLFxyXG4gICAgICB0aGlzLndvcmxkV2lkdGgsXHJcbiAgICAgIHRoaXMud29ybGRIZWlnaHRcclxuICAgICk7XHJcblxyXG4gICAgYXBwLmdhbWUuZGVidWcucmVjdGFuZ2xlKHJlY3QsICcjZTMwMGZmJywgZmFsc2UpO1xyXG4gIH1cclxufVxyXG5cclxuY29tcG9uZW50KCdib3VuZHMnLCAoZW50aXR5LCAuLi5hcmdzKSA9PiB7XHJcbiAgY29uc3QgcG9zaXRpb24gPSBlbnRpdHkubWFuZGF0ZSgncG9zaXRpb24nKTtcclxuICByZXR1cm4gbmV3IEJvdW5kcyhwb3NpdGlvbiwgLi4uYXJncyk7XHJcbn0pO1xyXG4iLCJleHBvcnQgeyBkZWZhdWx0IGFzIHNwcml0ZSB9IGZyb20gJy4vc3ByaXRlJztcbmV4cG9ydCB7IGRlZmF1bHQgYXMgcmVuZGVyYWJsZSB9IGZyb20gJy4vcmVuZGVyYWJsZSc7XG5leHBvcnQgeyBkZWZhdWx0IGFzIHNwYXduYWJsZSB9IGZyb20gJy4vc3Bhd25hYmxlJztcbmV4cG9ydCB7IGRlZmF1bHQgYXMgcG9zaXRpb24gfSBmcm9tICcuL3Bvc2l0aW9uJztcbmV4cG9ydCB7IGRlZmF1bHQgYXMgYm91bmRzIH0gZnJvbSAnLi9ib3VuZHMnO1xuZXhwb3J0IHsgZGVmYXVsdCBhcyBwb3NpdGlvbkJvdW5kU3ByaXRlIH0gZnJvbSAnLi9wb3NpdGlvbi1ib3VuZC1zcHJpdGUnO1xuIiwiaW1wb3J0IHsgY29tcG9uZW50IH0gZnJvbSAnZ2VvdGljJztcclxuaW1wb3J0IHsgYXBwIH0gZnJvbSAnLi8uLi9hcHAnO1xyXG5cclxuY2xhc3MgUG9zaXRpb25Cb3VuZFNwcml0ZSB7XHJcbiAgY29uc3RydWN0b3IocG9zaXRpb24sIHNwcml0ZSwgb2Zmc2V0WCA9IDAsIG9mZnNldFkgPSAwKSB7XHJcbiAgICB0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XHJcbiAgICB0aGlzLnNwcml0ZSA9IHNwcml0ZTtcclxuICAgIHRoaXMub2Zmc2V0WCA9IG9mZnNldFg7XHJcbiAgICB0aGlzLm9mZnNldFkgPSBvZmZzZXRZO1xyXG4gICAgdGhpcy5zeW5jaHJvbml6ZVNwcml0ZSgpXHJcbiAgfVxyXG5cclxuICBzeW5jaHJvbml6ZVNwcml0ZSgpIHtcclxuICAgIHRoaXMuc3ByaXRlLnggPSB0aGlzLnBvc2l0aW9uLndvcmxkWCArIHRoaXMub2Zmc2V0WDtcclxuICAgIHRoaXMuc3ByaXRlLnkgPSB0aGlzLnBvc2l0aW9uLndvcmxkWSArIHRoaXMub2Zmc2V0WTtcclxuICB9XHJcbn1cclxuXHJcbmNvbXBvbmVudCgncG9zaXRpb24tYm91bmQtc3ByaXRlJywgKGVudGl0eSwgLi4uYXJncykgPT4ge1xyXG4gIGNvbnN0IHBvc2l0aW9uID0gZW50aXR5Lm1hbmRhdGUoJ3Bvc2l0aW9uJyk7XHJcbiAgY29uc3Qgc3ByaXRlID0gZW50aXR5Lm1hbmRhdGUoJ3Nwcml0ZScpO1xyXG4gIGNvbnN0IGJpbmRlciA9IG5ldyBQb3NpdGlvbkJvdW5kU3ByaXRlKHBvc2l0aW9uLCBzcHJpdGUsIC4uLmFyZ3MpO1xyXG5cclxuICBlbnRpdHkub24oJ3Bvc2l0aW9uLWNoYW5nZWQnLCBiaW5kZXIuc3luY2hyb25pemVTcHJpdGUuYmluZChiaW5kZXIpKTtcclxuXHJcbiAgcmV0dXJuIGJpbmRlcjtcclxufSk7XHJcbiIsImltcG9ydCB7IGNvbXBvbmVudCB9IGZyb20gJ2dlb3RpYyc7XHJcbmltcG9ydCB7IGFwcCB9IGZyb20gJy4vLi4vYXBwJztcclxuXHJcbmNsYXNzIFBvc2l0aW9uIHtcclxuICBjb25zdHJ1Y3RvcihlbnRpdHksIHggPSAwLCB5ID0gMCkge1xyXG4gICAgdGhpcy5lbnRpdHkgPSBlbnRpdHk7XHJcbiAgICB0aGlzLl94ID0geDtcclxuICAgIHRoaXMuX3kgPSB5O1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNvbXBhY3RlZCgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHg6IHRoaXMuX3gsXHJcbiAgICAgIHk6IHRoaXMuX3ksXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0IHgobmV3WCkge1xyXG4gICAgY29uc3Qgb2xkUG9zaXRpb24gPSB0aGlzLmNvbXBhY3RlZDtcclxuICAgIHRoaXMuX3ggPSBuZXdYO1xyXG4gICAgY29uc3QgbmV3UG9zaXRpb24gPSB0aGlzLmNvbXBhY3RlZDtcclxuICAgIGNvbnNvbGUubG9nKCdlbWl0IHBvc2l0aW9uIGNoYW5nZWQnKTtcclxuICAgIHRoaXMuZW50aXR5LmVtaXQoJ3Bvc2l0aW9uLWNoYW5nZWQnLCBvbGRQb3NpdGlvbiwgbmV3UG9zaXRpb24pO1xyXG4gIH1cclxuXHJcbiAgc2V0IHkobmV3WSkge1xyXG4gICAgY29uc3Qgb2xkUG9zaXRpb24gPSB0aGlzLmNvbXBhY3RlZDtcclxuICAgIHRoaXMuX3kgPSBuZXdZO1xyXG4gICAgY29uc3QgbmV3UG9zaXRpb24gPSB0aGlzLmNvbXBhY3RlZDtcclxuICAgIHRoaXMuZW50aXR5LmVtaXQoJ3Bvc2l0aW9uLWNoYW5nZWQnLCBvbGRQb3NpdGlvbiwgbmV3UG9zaXRpb24pO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHgoKSB7IHJldHVybiB0aGlzLl94OyB9XHJcbiAgZ2V0IHkoKSB7IHJldHVybiB0aGlzLl95OyB9XHJcblxyXG4gIGdldCB3b3JsZFgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5feCAqIGFwcC5jb25zdGFudHMuVElMRV9TSVpFO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHdvcmxkWSgpIHtcclxuICAgIHJldHVybiB0aGlzLl95ICogYXBwLmNvbnN0YW50cy5USUxFX1NJWkU7XHJcbiAgfVxyXG59XHJcblxyXG5jb21wb25lbnQoJ3Bvc2l0aW9uJywgKGVudGl0eSwgeCA9IDAsIHkgPSAwKSA9PiBuZXcgUG9zaXRpb24oZW50aXR5LCB4LCB5KSk7XHJcbiIsImltcG9ydCB7IGNvbXBvbmVudCB9IGZyb20gJ2dlb3RpYyc7XHJcbmltcG9ydCB7IGFwcCB9IGZyb20gJy4vLi4vYXBwJztcclxuXHJcbmNsYXNzIFJlbmRlcmFibGUge1xyXG4gIGNvbnN0cnVjdG9yKHN1YmplY3QpIHtcclxuICAgIHRoaXMuc3ViamVjdCA9IHN1YmplY3Q7XHJcbiAgfVxyXG5cclxuICByZW5kZXIoY2FudmFzKSB7XHJcbiAgICByZXR1cm4gY2FudmFzLmFkZCh0aGlzLnN1YmplY3QpO1xyXG4gIH1cclxufVxyXG5cclxuY29tcG9uZW50KCdyZW5kZXJhYmxlJywgKGVudGl0eSwgc3ViamVjdCkgPT4ge1xyXG4gIGNvbnN0IHIgPSBuZXcgUmVuZGVyYWJsZShzdWJqZWN0KTtcclxuICBlbnRpdHkucmVuZGVyID0gci5yZW5kZXIuYmluZChyKTtcclxuICByZXR1cm4gcjtcclxufSk7XHJcbiIsImltcG9ydCB7IGNvbXBvbmVudCB9IGZyb20gJ2dlb3RpYyc7XHJcbmltcG9ydCB7IGFwcCB9IGZyb20gJy4vLi4vYXBwJztcclxuXHJcbmNsYXNzIFNwYXduYWJsZSB7XHJcbiAgY29uc3RydWN0b3IoZW50aXR5LCB0ZXN0KSB7XHJcbiAgICB0aGlzLmVudGl0eSA9IGVudGl0eTtcclxuICAgIHRoaXMudGVzdCA9IHRlc3Q7XHJcbiAgICB0aGlzLmVudGl0eS5zcGF3biA9IHRoaXMuc3Bhd24uYmluZCh0aGlzKTtcclxuICAgIHRoaXMuZW50aXR5LmNhblNwYXduQXQgPSB0aGlzLmNhblNwYXduQXQuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIGNhblNwYXduQXQoeCwgeSkge1xyXG4gICAgcmV0dXJuIHRoaXMudGVzdCh4LCB5KTtcclxuICB9XHJcblxyXG4gIHNwYXduKCkge1xyXG4gICAgdGhpcy5lbnRpdHkuZW1pdCgnc3Bhd24nKTtcclxuICAgIHJldHVybiB0aGlzLmVudGl0eTtcclxuICB9XHJcbn1cclxuXHJcbmNvbXBvbmVudCgnc3Bhd25hYmxlJywgKGVudGl0eSwgdGVzdCA9ICgpID0+IHt9KSA9PiBuZXcgU3Bhd25hYmxlKGVudGl0eSwgdGVzdCkpO1xyXG4iLCJpbXBvcnQgeyBjb21wb25lbnQgfSBmcm9tICdnZW90aWMnO1xyXG5pbXBvcnQgeyBhcHAgfSBmcm9tICcuLy4uL2FwcCc7XHJcblxyXG5jb21wb25lbnQoJ3Nwcml0ZScsIChlbnRpdHksIC4uLmFyZ3MpID0+IHtcclxuICBsZXQgeCwgeSA9IDA7XHJcbiAgbGV0IGtleSwgZnJhbWUgPSBudWxsO1xyXG5cclxuICBzd2l0Y2goYXJncy5sZW5ndGgpIHtcclxuICAgIGNhc2UgMDpcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIDE6XHJcbiAgICAgIGtleSA9IGFyZ3NbMF07XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAyOlxyXG4gICAgICBrZXkgPSBhcmdzWzBdO1xyXG4gICAgICBmcmFtZSA9IGFyZ3NbMV07XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAzOlxyXG4gICAgICB4ID0gYXJnc1swXTtcclxuICAgICAgeSA9IGFyZ3NbMV07XHJcbiAgICAgIGtleSA9IGFyZ3NbMl07XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSA0OlxyXG4gICAgICB4ID0gYXJnc1swXTtcclxuICAgICAgeSA9IGFyZ3NbMV07XHJcbiAgICAgIGtleSA9IGFyZ3NbMl07XHJcbiAgICAgIGZyYW1lID0gYXJnc1szXTtcclxuICAgICAgYnJlYWs7XHJcbiAgfVxyXG5cclxuICBjb25zdCBzcHJpdGUgPSBuZXcgUGhhc2VyLlNwcml0ZShhcHAuZ2FtZSwgeCwgeSwga2V5LCBmcmFtZSk7XHJcbiAgc3ByaXRlLnVubW91bnQgPSAoZSkgPT4ge1xyXG4gICAgc3ByaXRlLmRlc3Ryb3koKTtcclxuICB9O1xyXG5cclxuICBlbnRpdHkubWFuZGF0ZSgncmVuZGVyYWJsZScsIHNwcml0ZSk7XHJcbiAgcmV0dXJuIHNwcml0ZTtcclxufSk7XHJcbiIsImltcG9ydCBlbnRpdGllcyBmcm9tICcuL2luZGV4JztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudGl0eUZhY3Rvcnkge1xyXG4gIHRvd2VyKHgsIHkpIHtcclxuICAgIHJldHVybiBlbnRpdGllcy50b3dlcih4LCB5KTtcclxuICB9XHJcbiAgc2hydWIoeCwgeSkge1xyXG4gICAgcmV0dXJuIGVudGl0aWVzLnNocnViKHgsIHkpO1xyXG4gIH1cclxuICBwaW5lVHJlZSh4LCB5KSB7XHJcbiAgICByZXR1cm4gZW50aXRpZXMucGluZVRyZWUoeCwgeSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB0b3dlciBmcm9tICcuL3Rvd2VyJztcbmltcG9ydCBzaHJ1YiBmcm9tICcuL3NocnViJztcbmltcG9ydCBwaW5lVHJlZSBmcm9tICcuL3BpbmUtdHJlZSc7XG5cbmV4cG9ydCB7IHRvd2VyIH07XG5leHBvcnQgeyBzaHJ1YiB9O1xuZXhwb3J0IHsgcGluZVRyZWUgfTtcbmV4cG9ydCBkZWZhdWx0IHsgdG93ZXIsIHNocnViLCBwaW5lVHJlZSB9O1xuIiwiaW1wb3J0IHsgZW50aXR5IH0gZnJvbSAnZ2VvdGljJztcclxuaW1wb3J0IGdlb3RpYyBmcm9tICdnZW90aWMnO1xyXG5pbXBvcnQgYXBwIGZyb20gJy4uL2FwcCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCAoeCwgeSkgPT4ge1xyXG4gIGNvbnN0IHRyZWUgPSBlbnRpdHkoKVxyXG4gICAgLmFkZCgncG9zaXRpb24nLCB4LCB5KVxyXG4gICAgLmFkZCgnc3ByaXRlJywgJ3BpbmUtdHJlZScpXHJcbiAgICAuYWRkKCdwb3NpdGlvbi1ib3VuZC1zcHJpdGUnLCAwLCAtMTYpXHJcbiAgICAuYWRkKCdzcGF3bmFibGUnLCAoeCwgeSkgPT4ge1xyXG4gICAgICByZXR1cm4gZ2VvdGljXHJcbiAgICAgICAgLmZpbmRCeUNvbXBvbmVudCgnYm91bmRzJylcclxuICAgICAgICAuZXZlcnkoZSA9PiAhdHJlZS5ib3VuZHMuY29sbGlkZXNXaXRoKGUuYm91bmRzKSk7XHJcbiAgICB9KVxyXG4gICAgLmFkZCgnYm91bmRzJylcclxuICAgIC5vbmNlKCdzcGF3bicsICgpID0+IHtcclxuICAgICAgdHJlZS5yZW5kZXIoYXBwLm1hcC5zdGF0aWMpO1xyXG4gICAgICBhcHAubWFwLnN0YXRpYy5zb3J0KCd5Jyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCd0cmVlIHNwYXduZWQuJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICB0cmVlLmRlc3Ryb3koKTtcclxuICB9LCAyMDAwKTtcclxuXHJcbiAgcmV0dXJuIHRyZWU7XHJcbn07XHJcbiIsImltcG9ydCB7IGVudGl0eSB9IGZyb20gJ2dlb3RpYyc7XHJcbmltcG9ydCBhcHAgZnJvbSAnLi4vYXBwJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0ICh4LCB5KSA9PiB7XHJcbiAgY29uc3Qgc2hydWIgPSBlbnRpdHkoKVxyXG4gICAgLmFkZCgnc3ByaXRlJywgYXBwLndvcmxkWCh4KSwgYXBwLndvcmxkWSh5KSwgMzIsIDMyLCAnc2hydWInKVxyXG4gICAgLmFkZCgnc3Bhd25hYmxlJylcclxuICAgIC5vbignc3Bhd24nLCAoKSA9PiBzaHJ1Yi5yZW5kZXIoYXBwLm1hcC5zdGF0aWMpKTtcclxuXHJcbiAgcmV0dXJuIHNocnViO1xyXG59O1xyXG4iLCJpbXBvcnQgeyBlbnRpdHkgfSBmcm9tICdnZW90aWMnO1xyXG5pbXBvcnQgYXBwIGZyb20gJy4uL2FwcCc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCAoeCwgeSkgPT4ge1xyXG4gIGNvbnN0IHRvd2VyID0gZW50aXR5KClcclxuICAgIC5hZGQoJ3Nwcml0ZScsIGFwcC53b3JsZFgoeCksIGFwcC53b3JsZFkoeSkgLSAxNiwgMTYsIDMyLCAndG93ZXInKVxyXG4gICAgLmFkZCgnc3Bhd25hYmxlJyk7XHJcbiAgICAvLyAub24oJ3NwYXduJywgKCkgPT4gdG93ZXIucmVuZGVyKGFwcC5tYXAud2FsbHMpKTtcclxuXHJcbiAgcmV0dXJuIHRvd2VyO1xyXG59O1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDb21tYW5kUXVldWUge1xyXG4gIGNvbnN0cnVjdG9yKGNvbW1hbmRzID0gW10pIHtcclxuICAgIHRoaXMuY29tbWFuZHMgPSBbXTtcclxuICAgIGNvbW1hbmRzLmZvckVhY2goYyA9PiB0aGlzLnB1c2goYykpO1xyXG4gIH1cclxuXHJcbiAgcHJvY2VzcygpIHtcclxuICAgIGlmICh0aGlzLmNvbW1hbmRzLmxlbmd0aCkge1xyXG4gICAgICBjb25zdCBjb21tYW5kID0gdGhpcy5jb21tYW5kcy5zaGlmdCgpO1xyXG4gICAgICBjb21tYW5kLmV4ZWN1dGUoKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBwcm9jZXNzQWxsKCkge1xyXG4gICAgdGhpcy5wcm9jZXNzKCkgJiYgdGhpcy5wcm9jZXNzQWxsKCk7XHJcbiAgfVxyXG5cclxuICBwdXNoKGNvbW1hbmQpIHtcclxuICAgIHRoaXMuY29tbWFuZHMucHVzaChjb21tYW5kKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29tbWFuZCB7XHJcbiAgZXhlY3V0ZSgpIHtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IENvbW1hbmQgZnJvbSAnLi9jb21tYW5kJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNwYXduRW50aXR5Q29tbWFuZCBleHRlbmRzIENvbW1hbmQge1xyXG4gIGNvbnN0cnVjdG9yKGVudGl0eSkge1xyXG4gICAgc3VwZXIoKTtcclxuICAgIHRoaXMuZW50aXR5ID0gZW50aXR5O1xyXG4gIH1cclxuXHJcbiAgZXhlY3V0ZSgpIHtcclxuICAgIHRoaXMuZW50aXR5LnNwYXduKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIElucHV0Q29udHJvbGxlciB7XHJcbiAgY29uc3RydWN0b3IocXVldWUpIHtcclxuICAgIHRoaXMucXVldWUgPSBxdWV1ZTtcclxuICB9XHJcblxyXG4gIGhhbmRsZSgpIHtcclxuICB9XHJcblxyXG4gIHF1ZXVlQ29tbWFuZChjb21tYW5kKSB7XHJcbiAgICB0aGlzLnF1ZXVlLnB1c2goY29tbWFuZCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBTcGF3bkVudGl0eUNvbW1hbmQgZnJvbSAnLi4vY29tbWFuZHMvc3Bhd24tZW50aXR5LWNvbW1hbmQnO1xyXG5pbXBvcnQgSW5wdXRDb250cm9sbGVyIGZyb20gJy4vaW5wdXQtY29udHJvbGxlcic7XHJcbmltcG9ydCBhcHAgZnJvbSAnLi4vLi4vYXBwJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1hcElucHV0Q29udHJvbGxlciBleHRlbmRzIElucHV0Q29udHJvbGxlciB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcihhcHAuY29tbWFuZFF1ZXVlKTtcclxuICAgIHRoaXMuY3Vyc29yID0gYXBwLmN1cnNvcjtcclxuICAgIHRoaXMub2xkTW91c2VYID0gMDtcclxuICAgIHRoaXMub2xkTW91c2VZID0gMDtcclxuICB9XHJcblxyXG4gIGhhbmRsZSgpIHtcclxuICAgIHRoaXMubW91c2VYID0gYXBwLmlucHV0LmFjdGl2ZVBvaW50ZXIud29ybGRYO1xyXG4gICAgdGhpcy5tb3VzZVkgPSBhcHAuaW5wdXQuYWN0aXZlUG9pbnRlci53b3JsZFk7XHJcbiAgICB0aGlzLnRpbGVYID0gYXBwLnRpbGVYKHRoaXMubW91c2VYKTtcclxuICAgIHRoaXMudGlsZVkgPSBhcHAudGlsZVkodGhpcy5tb3VzZVkpO1xyXG5cclxuICAgIGlmICh0aGlzLmxlZnRNb3VzZUJ1dHRvbkRvd24pIHtcclxuICAgICAgY29uc3QgcGluZSA9IGFwcC5jcmVhdGUucGluZVRyZWUodGhpcy50aWxlWCwgdGhpcy50aWxlWSk7XHJcblxyXG4gICAgICBpZiAocGluZS5jYW5TcGF3bkF0KHRoaXMudGlsZVgsIHRoaXMudGlsZVkpKSB7XHJcbiAgICAgICAgY29uc3QgY29tbWFuZCA9IG5ldyBTcGF3bkVudGl0eUNvbW1hbmQocGluZSk7XHJcbiAgICAgICAgdGhpcy5xdWV1ZUNvbW1hbmQoY29tbWFuZCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcGluZS5kZXN0cm95KCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5yaWdodE1vdXNlQnV0dG9uRG93bikge1xyXG4gICAgICBjb25zb2xlLmxvZygncm1iJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5vbGRNb3VzZVggPSB0aGlzLm1vdXNlWDtcclxuICAgIHRoaXMub2xkTW91c2VZID0gdGhpcy5tb3VzZVk7XHJcbiAgfVxyXG5cclxuICBnZXQgbW91c2VQb3NpdGlvbkNoYW5nZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5vbGRNb3VzZVggIT0gdGhpcy5tb3VzZVggfHwgdGhpcy5vbGRNb3VzZVkgIT0gdGhpcy5tb3VzZVk7XHJcbiAgfVxyXG5cclxuICBnZXQgbGVmdE1vdXNlQnV0dG9uRG93bigpIHtcclxuICAgIHJldHVybiBhcHAuaW5wdXQubW91c2VQb2ludGVyLmxlZnRCdXR0b24uaXNEb3duXHJcbiAgfVxyXG5cclxuICBnZXQgcmlnaHRNb3VzZUJ1dHRvbkRvd24oKSB7XHJcbiAgICByZXR1cm4gYXBwLmlucHV0Lm1vdXNlUG9pbnRlci5yaWdodEJ1dHRvbi5pc0Rvd25cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFRpbGUgZnJvbSAnLi90aWxlJztcclxuXHJcblBoYXNlci5UaWxlID0gVGlsZTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGlsZSBleHRlbmRzIFBoYXNlci5UaWxlIHtcclxuICAvKipcclxuICAgKiBHZXQgYmluYXJ5IHN1bSBvZiBhbGwgbmVpZ2hib3JzLlxyXG4gICAqL1xyXG4gIGJpbmFyeVN1bSh0ZXN0KSB7XHJcbiAgICBsZXQgc3VtID0gMDtcclxuICAgIGxldCBtdWx0aXBsaWVyID0gMjU2O1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAtMTsgaSA8PSAxOyBpKyspIHtcclxuICAgICAgY29uc3QgeSA9IHRoaXMueSAtIGk7XHJcbiAgICAgIGNvbnN0IHJvdyA9IHRoaXMubGF5ZXIuZGF0YVt5XTtcclxuXHJcbiAgICAgIGZvciAobGV0IGogPSAtMTsgaiA8PSAxOyBqKyspIHtcclxuICAgICAgICBpZiAoaSA9PT0gMCAmJiBqID09PSAwKSBjb250aW51ZTtcclxuICAgICAgICBjb25zdCB4ID0gdGhpcy54IC0gajtcclxuICAgICAgICBjb25zdCB0aWxlID0gcm93ICYmIHggaW4gcm93ID8gcm93W3hdIDogbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKHRlc3QodGlsZSkpIHN1bSArPSBtdWx0aXBsaWVyO1xyXG5cclxuICAgICAgICBtdWx0aXBsaWVyIC89IDI7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gc3VtO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGJpbmFyeSBzdW0gb2YgbmVpZ2hib3JzIG9ubHkgdGFraW5nIGludG8gYWNjb3VudFxyXG4gICAqIHRoZSB0b3AsIGxlZnQsIHJpZ2h0LCBhbmQgYm90dG9tIHRpbGVzLlxyXG4gICAqL1xyXG4gIGJpbmFyeVN1bVNpbXBsZSh0ZXN0KSB7XHJcbiAgICBsZXQgc3VtID0gMDtcclxuXHJcbiAgICBjb25zdCBnZXROZWlnaGJvciA9ICh4LCB5KSA9PiB7XHJcbiAgICAgIGlmICh5IGluIHRoaXMubGF5ZXIuZGF0YSkge1xyXG4gICAgICAgIGlmICh4IGluIHRoaXMubGF5ZXIuZGF0YVt5XSkgcmV0dXJuIHRoaXMubGF5ZXIuZGF0YVt4XVt5XTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgdG9wID0gZ2V0TmVpZ2hib3IodGhpcy55IC0gMSwgdGhpcy54KTtcclxuICAgIGNvbnN0IGxlZnQgPSBnZXROZWlnaGJvcih0aGlzLnksIHRoaXMueCAtIDEpO1xyXG4gICAgY29uc3QgcmlnaHQgPSBnZXROZWlnaGJvcih0aGlzLnksIHRoaXMueCArIDEpO1xyXG4gICAgY29uc3QgYm90dG9tID0gZ2V0TmVpZ2hib3IodGhpcy55ICsgMSwgdGhpcy54KTtcclxuXHJcbiAgICBpZiAodGVzdCh0b3ApKSBzdW0gKz0gNDtcclxuICAgIGlmICh0ZXN0KGxlZnQpKSBzdW0gKz0gMTY7XHJcbiAgICBpZiAodGVzdChyaWdodCkpIHN1bSArPSAzMjtcclxuICAgIGlmICh0ZXN0KGJvdHRvbSkpIHN1bSArPSAxMjg7XHJcblxyXG4gICAgcmV0dXJuIHN1bTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEJvb2xlYW4gY2hlY2sgaWYgdGhpcyB0aWxlIGV4aXN0cyBvbiB0aGUgbGF5ZXIgYm91bmRhcnlcclxuICAgKi9cclxuICBhdEJvdW5kYXJ5KCkge1xyXG4gICAgcmV0dXJuIHRoaXMueCA9PT0gMFxyXG4gICAgICB8fCB0aGlzLnkgPT09IDBcclxuICAgICAgfHwgdGhpcy54ID09PSB0aGlzLmxheWVyLndpZHRoIC0gMVxyXG4gICAgICB8fCB0aGlzLnkgPT09IHRoaXMubGF5ZXIuaGVpZ2h0IC0gMTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IGFwcCBmcm9tICcuLi9hcHAnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFwIHtcclxuICBjb25zdHJ1Y3RvcihsZXZlbCkge1xyXG4gICAgdGhpcy50aWxlbWFwID0gYXBwLmdhbWUuYWRkLnRpbGVtYXAobGV2ZWwpO1xyXG4gICAgdGhpcy50aWxlbWFwLmFkZFRpbGVzZXRJbWFnZSgndGVycmFpbicsICd0ZXJyYWluJyk7XHJcblxyXG4gICAgdGhpcy5iYWNrZ3JvdW5kID0gdGhpcy50aWxlbWFwLmNyZWF0ZUxheWVyKCdiYWNrZ3JvdW5kJyk7XG5cbiAgICB0aGlzLnN0YXRpYyA9IGFwcC5nYW1lLmFkZC5ncm91cCgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgYXBwIGZyb20gJy4uL2FwcCc7XHJcbmltcG9ydCBlbnRpdGllcyBmcm9tICcuLi9lbnRpdGllcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIGV4dGVuZHMgUGhhc2VyLlN0YXRlIHtcclxuICBjcmVhdGUoKSB7XHJcbiAgICBhcHAuaW5pdCh0aGlzLmdhbWUpO1xyXG5cclxuICAgIGNvbnN0IHRyZWUxID0gYXBwXHJcbiAgICAgIC5jcmVhdGVcclxuICAgICAgLnBpbmVUcmVlKDgsIDQpXHJcbiAgICAgIC5zcGF3bigpO1xyXG5cclxuICAgIGNvbnN0IHRyZWUyID0gYXBwXHJcbiAgICAgIC5jcmVhdGVcclxuICAgICAgLnBpbmVUcmVlKDYsIDUpXHJcbiAgICAgIC5zcGF3bigpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlKCkge1xyXG4gICAgYXBwLnVwZGF0ZSgpO1xyXG4gIH1cclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTG9hZGluZyBleHRlbmRzIFBoYXNlci5TdGF0ZSB7XHJcbiAgcHJlbG9hZCgpIHtcclxuICAgIHRoaXMuZ2FtZS5zdGFnZS5zbW9vdGhlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5sb2FkaW5nQmFyID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUodGhpcy5nYW1lLndvcmxkLmNlbnRlclgsIHRoaXMuZ2FtZS53b3JsZC5jZW50ZXJZICsgMTI4LCAnbG9hZGluZy1iYXInKTtcclxuICAgIHRoaXMubG9hZGluZ0Jhci5hbmNob3Iuc2V0VG8oMC41KTtcclxuICAgIHRoaXMubG9hZC5zZXRQcmVsb2FkU3ByaXRlKHRoaXMubG9hZGluZ0Jhcik7XHJcblxyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdncm91bmQnLCAnaW1nL2dyb3VuZC5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgndGVycmFpbicsICdpbWcvdGVycmFpbi0xNi5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgnd2FsbCcsICdpbWcvd2FsbHMucG5nJyk7XHJcbiAgICB0aGlzLmxvYWQuaW1hZ2UoJ3Rvd2VyJywgJ2ltZy90b3dlci5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgnZmxhZycsICdpbWcvZmxhZy5wbmcnKTtcclxuICAgIHRoaXMubG9hZC5pbWFnZSgnc2hydWInLCAnaW1nL3NocnViLnBuZycpO1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdwaW5lLXRyZWUnLCAnaW1nL3BpbmUtdHJlZS5wbmcnKTtcclxuXHJcbiAgICB0aGlzLmxvYWQudGlsZW1hcCgnaXNsYW5kJywgJ21hcHMvaXNsYW5kLmpzb24nLCBudWxsLCBQaGFzZXIuVGlsZW1hcC5USUxFRF9KU09OKTtcclxuICAgIHRoaXMubG9hZC50aWxlbWFwKCdjcmF6eXRvd24nLCAnbWFwcy9jcmF6eXRvd24uanNvbicsIG51bGwsIFBoYXNlci5UaWxlbWFwLlRJTEVEX0pTT04pO1xyXG4gICAgdGhpcy5sb2FkLnRpbGVtYXAoJ3RpbnknLCAnbWFwcy90aW55Lmpzb24nLCBudWxsLCBQaGFzZXIuVGlsZW1hcC5USUxFRF9KU09OKTtcclxuICAgIHRoaXMubG9hZC50aWxlbWFwKCdwYXJhZGlzZScsICdtYXBzL3BhcmFkaXNlLmpzb24nLCBudWxsLCBQaGFzZXIuVGlsZW1hcC5USUxFRF9KU09OKTtcclxuXHJcbiAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2N1cnNvcicsICdpbWcvY3Vyc29yLnBuZycsIDE2LCAxNik7XHJcbiAgICB0aGlzLmxvYWQuYXRsYXMoJ3dhbGxzJywgJ2ltZy93YWxscy5wbmcnLCAnYXRsYXMvd2FsbHMuanNvbicpO1xyXG4gICAgdGhpcy5sb2FkLmF0bGFzKCdpbnRlcmlvcicsICdpbWcvaW50ZXJpb3Itb3JhbmdlLnBuZycsICdhdGxhcy9pbnRlcmlvci5qc29uJyk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGUoKSB7XHJcbiAgICB0aGlzLmdhbWUuc3RhZ2Uuc21vb3RoZWQgPSBmYWxzZTtcclxuICAgIHRoaXMuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gJyMzMDYwODInO1xyXG4gICAgdGhpcy5zdGF0ZS5zdGFydCgnR2FtZScpO1xyXG4gIH1cclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJlbG9hZCBleHRlbmRzIFBoYXNlci5TdGF0ZSB7XHJcbiAgcHJlbG9hZCgpIHtcclxuICAgIHRoaXMuZ2FtZS5sb2FkLmltYWdlKCdsb2FkaW5nLWJhcicsICdpbWcvbG9hZGluZy1iYXIucG5nJyk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGUoKSB7XHJcbiAgICB0aGlzLmdhbWUuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gJyMzMDYwODInO1xyXG4gICAgdGhpcy5nYW1lLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuVVNFUl9TQ0FMRTtcclxuICAgIHRoaXMuZ2FtZS5zY2FsZS5zZXRVc2VyU2NhbGUoMiwgMik7XHJcblxyXG4gICAgdGhpcy5nYW1lLnJlbmRlcmVyLnJlbmRlclNlc3Npb24ucm91bmRQaXhlbHMgPSB0cnVlO1xyXG4gICAgUGhhc2VyLkNhbnZhcy5zZXRJbWFnZVJlbmRlcmluZ0NyaXNwKHRoaXMuZ2FtZS5jYW52YXMpO1xyXG5cclxuICAgIHRoaXMuc3RhdGUuc3RhcnQoJ0xvYWRpbmcnKTtcclxuICB9XHJcbn07XHJcbiIsImltcG9ydCBnZW90aWMgZnJvbSAnZ2VvdGljJztcclxuaW1wb3J0IGFwcCBmcm9tICcuLi9hcHAnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQm91bmRzU3lzdGVtIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuZGVidWcgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZSgpIHtcclxuICAgIGNvbnN0IGFjdG9ycyA9IGdlb3RpYy5maW5kQnlDb21wb25lbnQoJ2JvdW5kcycpO1xyXG5cclxuICAgIGlmICh0aGlzLmRlYnVnKSB7XHJcbiAgICAgIGFjdG9ycy5mb3JFYWNoKGFjdG9yID0+IHtcclxuICAgICAgICBhY3Rvci5ib3VuZHMuZGVidWcoKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBhcHAuZ2FtZS5kZWJ1Zy5yZXNldCgpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iXX0="}